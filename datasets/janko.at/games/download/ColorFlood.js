function ColorFlood(){var a=this;a.constructor();a.uis.puzzle=["Color Flood","Farbflutung"];var g=a.board.c,h=0,k=0;a.enable.hint=!1;a.enable.check=!1;a.enable.colors=!1;a.enable.smarkers=!1;a.enable.values=!1;a.enable.pgrid=!0;a.keypad.left=nil;a.keypad.right=nil;a.moves.collapse=!1;a.score.label=a.uis.get("moves");a.score.optimize=a.score.minimize;a.solutionToString=a.solutionToStringGame;a.showSolution=a.showSolutionGame;a.isNewSolution=a.isNewSolutionGame;a.myMake2=a.make2;a.infoText="\u2022";
var m=null,n=null;a.level.size=(15).toString();a.level.depth=(6).toString();a.init=function(){Object.getPrototypeOf(a).init.call(a)};a.run2=function(){try{a.config.mode==a.config.modeGame&&(a.level.size=(15).toString(),a.level.depth=(6).toString()),Object.getPrototypeOf(this).run2.call(this)}catch(c){throw a.exception(c),c;}};a.reset2=function(){try{h=a.size.x;k=a.size.y;a.charToValue=["1",0,"2",1,"3",2,"4",3,"5",4,"6",5,"7",6,"8",7,"9",8,"0",9].slice(0,2*a.size.z);if(a.level.problem)for(var c=0,
b=a.level.problem.replace(/\s+/g," ").trim().split(" "),d=0;d<k;d++)for(var e=0;e<h;e++){var f=g[e][d],l=b[c++];f.value=parseInt(l)}a.level.solution?a.level.moves=a.level.solution:a.level.moves&&(a.level.solution=a.level.moves)}catch(p){throw a.exception(p),p;}};a.make2=function(){try{h=a.size.x;k=a.size.y;for(var c="",b=0;b<k;b++)for(var d=0;d<h;d++)c+=a.random.getInt(a.size.z)+" ";a.level.problem=c;a.level.author="Otto Janko";a.level.source="Script/Gen";a.level.info=a.level.seed}catch(e){throw a.exception(e),
e;}};a.check2=function(){try{for(var c=g[0][0].value,b=0;b<h;b++)for(var d=0;d<k;d++)if(g[b][d].value!=c){a.solved=!1;return}}catch(e){throw a.exception(e),e;}};a.movesToString=function(){try{for(var c="",b="",d=0;d<a.moves.current+1;d++){var e=a.moves.list[d].split(",");b+=(parseInt(e[3])+1).toString();if(50<b.length||d==a.moves.current)c+=b+"\n",b=""}return c}catch(f){throw a.exception(f),f;}};a.movesFromString=function(c){try{a.checking.disable++;a.reset();a.moves.current=-1;a.moves.last=-1;c=
c.replace(/[\s,;]+/g,"");for(var b=0;b<c.length;b++){var d=c.charAt(b).charCodeAt(0)-48-1;a.makeMove(g[0][0],d,d)}}catch(e){ojdebug("Movelist: "+b+"\n",c),a.exception(e)}finally{a.checking.disable--}};a.makeMove2=function(c,b,d){try{if(null==b&&(b=d=c.value),g[0][0].value!=b){var e=g[0][0].value;a.makeMove3(0,0,e,b);g[0][0].value=e;Object.getPrototypeOf(this).makeMove2.call(this,g[0][0],b,d);a.score.current=a.moves.current+1}}catch(f){throw a.exception(f),f;}};a.makeMove3=function(c,b,d,e){try{g[c][b].value=
e,0<c&&g[c-1][b].value==d&&a.makeMove3(c-1,b,d,e),0<b&&g[c][b-1].value==d&&a.makeMove3(c,b-1,d,e),c<h-1&&g[c+1][b].value==d&&a.makeMove3(c+1,b,d,e),b<k-1&&g[c][b+1].value==d&&a.makeMove3(c,b+1,d,e)}catch(f){throw a.exception(f),f;}};a.onRun=function(){try{a.config.mode==a.config.modeGame&&(a.enable.make=!0);Object.getPrototypeOf(this).onRun.call(this);for(var c=0;9>c;c++){var b=document.createElement("canvas");b.className="oj-icon";b.id="oj-color-"+(c+1);b.style.cssText=a.css.icon;b.width=b.height=
a.uim.buttonSize;b.onmouseover=a.onButtonOver;b.onmouseout=a.onButtonOut;b.onmousedown=a.onButtonDown;b.onmouseup=a.onButtonUp;b.ontouchstart=a.onButtonDown;b.ontouchend=a.onButtonUp;b.ontouchmove=a.onButtonOver;b.oncontextmenu=a.onContextMenu;b.ojdata={};b.ojdata.cb=a.onColor;b.ojdata.value=c+1;b.ojdata.color=a.uic.light[c+1];a.uie.toolbar.appendChild(b);var d=b.getContext("2d");d.fillStyle=b.ojdata.color;d.fillRect(0,0,b.width,b.height);d.fillStyle=a.uic.black;a.paintText(b.ojdata.value.toString(),
d,{x:0,y:0,w:b.width,h:b.height,scale:80})}if(a.config.mode==a.config.modeGame){var e=document.createElement("select");for(c=10;30>=c;c+=5){var f=document.createElement("option");f.value=c.toString();f.textContent=c.toString()+"\u00d7"+c.toString();e.appendChild(f)}e.value=15;e.style.position="relative";e.style.top="-6px";a.uie.toolbar.insertBefore(e,a.uie.make);m=e;e=document.createElement("select");for(c=3;6>=c;c+=1)f=document.createElement("option"),f.value=c.toString(),f.textContent="Farben: "+
c.toString(),e.appendChild(f);e.value=6;e.style.position="relative";e.style.top="-6px";a.uie.toolbar.insertBefore(e,a.uie.make);n=e}}catch(l){throw a.exception(l),l;}};a.onSetup=function(){try{for(var c=0;9>c;c++)document.getElementById("oj-color-"+(c+1)).style.display=c<a.size.z?"":"none";Object.getPrototypeOf(this).onSetup.call(this)}catch(b){throw a.exception(b),b;}};a.onColor=function(c,b){try{a.makeMove(g[0][0],b.target.ojdata.value-1)}catch(d){throw a.exception(d),d;}};a.onMake=function(c){try{a.enable.make&&
(a.level.depth=n.value,a.level.rows=a.level.cols=m.value,a.setup())}catch(b){throw a.exception(b),b;}};a.onKeyPress=function(c){try{c=c||window.event;var b=0!=c.which&&0!=c.charCode?String.fromCharCode(c.which):-1;"1"<=b&&"9">=b&&null==a.current.item&&(a.current.item=g[0][0]);Object.getPrototypeOf(this).onKeyPress.call(this,c)}catch(d){throw a.exception(d),d;}};a.paintInfo=function(c){try{c=a.uis.get("colors")+": 1~"+a.size.z+" \u2022 ",c+=a.uis.get("moves")+": "+a.score.current+" ("+a.score.best+
") ["+a.score.high+"] ",Object.getPrototypeOf(this).paintInfo.call(this,c)}catch(b){throw a.exception(b),b;}};a.paintCell=function(c){try{var b=a.canvas.getContext("2d");b.fillStyle=a.uic.light[(c.value+1)%10];b.fillRect(c.px,c.py,a.unit.x,a.unit.y)}catch(d){throw a.exception(d),d;}}}ColorFlood.prototype=new Puzzle;
