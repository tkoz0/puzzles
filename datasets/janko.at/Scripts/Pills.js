function Pills(){var a=this;a.constructor();a.uis.puzzle=["Pills","Pillen"];a.cell.values=[0,1,nil];a.line.values=[a.line.wall,a.line.cross,a.line.grid];a.cell.nilalias=0;a.charToValue=a.charToValue.concat(["a",0,"s",1,"d",nil,"x",0,"c",1,"v",nil,",",0,".",1,"-",nil,"/",nil]);a.enable.dragging=!0;a.enable.cells=!0;a.enable.lines=!a.config.touch;a.keypad.left=nil;a.labels.north=a.labels.west=1;a.labels.east=3;var q=a.labels.west,m=a.labels.north,l=0,k=0;a.init=function(){Object.getPrototypeOf(a).init.call(a)};
a.reset2=function(){try{var b=a.board.c;l=a.size.x-a.labels.east;k=a.size.y-a.labels.south;a.cell.min=1;a.cell.max=a.size.z;if(a.level.problem){var e=0;var f=a.level.problem.replace(/\s+/g," ").trim().split(" ");for(var c=0;c<k;c++)for(var d=0;d<l;d++){var h=a.board.c[d][c];var g=f[e++];h.label="-"==g||"."==g?nil:"a"<=g&&"z">=g?g.charCodeAt(0)-96:"A"<=g&&"Z">=g?g.charCodeAt(0)-64:parseInt(g)}}if(a.level.solution){e=0;f=a.level.solution.replace(/\s+/g," ").trim().split(" ");for(c=m;c<k;c++)for(d=q;d<
l;d++)h=a.board.c[d][c],g=f[e++],"."==g||"-"==g||"0"==g?(h.solution=0,h.work=nil):h.work=parseInt(g);var t=1;for(d=q;d<l;d++)for(c=m;c<k;c++)if(b[d][c].work!=nil){var v=a.board.c[d][c].work;for(g=q;g<l;g++)for(f=m;f<k;f++)h=b[g][f],h.work==v&&(h.solution=t,h.work=nil);t++}for(d=q+1;d<l;d++)for(c=m;c<k;c++)a.board.v[d][c].solution=b[d][c].solution!=b[d-1][c].solution?a.line.wall:a.line.grid;for(c=m+1;c<k;c++)for(d=q;d<k;d++)a.board.h[d][c].solution=b[d][c].solution!=b[d][c-1].solution?a.line.wall:
a.line.grid}for(c=0;c<a.size.y;++c)for(d=0;d<a.size.x;++d){if(0==d||0==c)b[d][c].valid=!1,b[d][c].fixed=!0,b[d][c].areas=a.cell.label;d>=l&&(b[d][c].valid=!1,b[d][c].fixed=!0,b[d][c].areas=a.cell.aside)}for(d=0;d<=a.size.x;d++)for(c=0;c<a.size.y;c++)if(0==d||d==a.size.x||b[d][c].areas!=nil||b[d-1][c].areas!=nil)a.board.v[d][c].fixed=!0;for(d=0;d<a.size.x;d++)for(c=0;c<=a.size.y;c++)if(0==c||c==a.size.y||b[d][c].areas!=nil||b[d][c-1].areas!=nil)a.board.h[d][c].fixed=!0;t=1;for(d=l+1;d<a.size.x;d++)for(c=
m;c<k;c++)t<=a.size.z&&(b[d][c].label=t++)}catch(u){throw a.exception(u),u;}};a.check=function(){try{if(Object.getPrototypeOf(this).check.call(this),a.solved)for(var b=q;b<l;b++)for(var e=m;e<k;e++){var f=a.board.c[b][e];0!=f.value&&(f.value=1)}}catch(c){throw a.exception(c),c;}};a.check2=function(){try{for(var b=a.board.c,e=1,f=q;f<l;f++)for(var c=m;c<k;c++)1==b[f][c].value&&0==b[f][c].count&&a.markArea(f,c,e++);for(f=q;f<l;f++)for(c=m;c<k;c++)b[f][c].value==nil&&(b[f][c].error=1);for(f=q;f<l;f++)if(a.board.c[f][0].label!=
nil){var d=0;for(c=m;c<k;c++)1==b[f][c].value&&(d+=b[f][c].label);d!=b[f][0].label&&(b[f][0].error=2)}for(c=m;c<k;c++)if(a.board.c[0][c].label!=nil){d=0;for(f=q;f<l;f++)1==b[f][c].value&&(d+=b[f][c].label);d!=b[0][c].label&&(b[0][c].error=2)}for(var h=[],g=0;g<=a.size.z;g++)h[g]=0;g=1;a:for(;g<e;g++)for(f=q;f<l;f++)for(c=m;c<k;c++)if(b[f][c].count==g){var t=0;d=0;for(var v=nil,u=nil,n=q;n<l;n++)for(var p=m;p<k;p++){var r=b[n][p];r.count==g&&(t++,d+=r.label,v=n,u=p)}if(3!=t){for(n=q;n<l;n++)for(p=
m;p<k;p++)r=b[n][p],r.count==g&&1==r.value&&(r.error=3,r.count=0);continue a}if(0==d||d>a.size.z){for(n=q;n<l;n++)for(p=m;p<k;p++)r=b[n][p],r.count==g&&(r.error=2,r.count=0);continue a}if(v==f+2&&a.board.c[f+1][c].count==g||u==c+2&&a.board.c[f][c+1].count==g)h[d]++;else for(n=q;n<l;n++)for(p=m;p<k;p++)b[n][p].count==g&&(b[n][p].error=3,b[n][p].count=0);continue a}e=1;for(f=l+1;f<a.size.x;f++)for(c=m;c<k;c++)e<=a.size.z&&(r=b[f][c],1>h[e]?r.error=4:1<h[e]&&(r.error=5),e++)}catch(w){throw a.exception(w),
w;}};a.markArea=function(b,e,f){try{var c=a.board.c;c[b][e].count=f;b!=q&&1==c[b-1][e].value&&0==c[b-1][e].count&&a.board.v[b][e].value!=a.line.wall&&a.markArea(b-1,e,f);b!=l-1&&1==c[b+1][e].value&&0==c[b+1][e].count&&a.board.v[b+1][e].value!=a.line.wall&&a.markArea(b+1,e,f);e!=m&&1==c[b][e-1].value&&0==c[b][e-1].count&&a.board.h[b][e].value!=a.line.wall&&a.markArea(b,e-1,f);e!=k-1&&1==c[b][e+1].value&&0==c[b][e+1].count&&a.board.h[b][e+1].value!=a.line.wall&&a.markArea(b,e+1,f)}catch(d){throw a.exception(d),
d;}};a.makeMove2=function(b,e,f){try{var c=a.board.c;Object.getPrototypeOf(this).makeMove2.call(this,b,e,f);if(b.type==a.item.cell){var d=b.x,h=b.y;if(0<d&&c[d-1][h].value!=nil){var g=a.board.v[d][h];c[d-1][h].value==b.value&&c[d-1][h].color==b.color||g.value==a.line.wall||(g.value=a.line.wall,g.color=0)}d<a.size.x-1&&c[d+1][h].value!=nil&&(g=a.board.v[d+1][h],c[d+1][h].value==b.value&&c[d+1][h].color==b.color||g.value==a.line.wall||(g.value=a.line.wall,g.color=0));0<h&&c[d][h-1].value!=nil&&(g=a.board.h[d][h],
c[d][h-1].value==b.value&&c[d][h-1].color==b.color||g.value==a.line.wall||(g.value=a.line.wall,g.color=0));h<a.size.y-1&&c[d][h+1].value!=nil&&(g=a.board.h[d][h+1],c[d][h+1].value==b.value&&c[d][h+1].color==b.color||g.value==a.line.wall||(g.value=a.line.wall,g.color=0))}}catch(t){throw a.exception(t),t;}};a.showSolution2=function(){try{for(var b=0;b<a.size.y;b++)for(var e=0;e<a.size.x;e++){var f=a.board.c[e][b];a.makeMove(f,0==f.solution?0:1,f.solution)}for(b=0;b<a.size.y;b++)for(e=0;e<a.size.x;e++)a.board.c[e][b].color=
0}catch(c){throw a.exception(c),c;}};a.showHint2=function(b){try{b.type!=a.item.cell?b.solution==a.line.wall?a.makeMove(b,a.line.wall,0):a.makeMove(b,a.line.cross,0):a.makeMove(b,0==b.solution?0:1,0)}catch(e){throw a.exception(e),e;}};a.isKnownSolution2a=function(){try{for(var b=0;b<a.board.l.length;b++)if(a.board.l[b].value!=a.board.l[b].solution)return!1;return!0}catch(e){throw a.exception(e),e;}};a.cleanSolution=function(){try{for(var b=0;b<a.size.y;b++)for(var e=0;e<a.size.x;e++){var f=a.board.c[e][b];
f.value=f.count}}catch(c){throw a.exception(c),c;}};a.solutionToString=function(b){try{if(!b)for(var e=0;e<a.size.y;e++)for(var f=0;f<a.size.x;f++){var c=a.board.c[f][e];c.work=c.value;c.value=c.count}var d=Object.getPrototypeOf(this).solutionToString.call(this,b);if(!b)for(e=0;e<a.size.y;e++)for(f=0;f<a.size.x;f++)c=a.board.c[f][e],c.value=c.work;return d}catch(h){throw a.exception(h),h;}};a.onValues=function(){try{a.config.touch?a.enable.lines?(a.enable.lines=!1,a.enable.cells=!0):(a.enable.lines=
!0,a.enable.cells=!1):Object.getPrototypeOf(this).onValues.call(this)}catch(b){throw a.exception(b),b;}};a.paintInit=function(){try{var b=a.size.x,e=a.labels.east;a.paintToImage&&a.solved&&(a.size.x-=3,a.labels.east=0);Object.getPrototypeOf(this).paintInit.call(this);a.size.x=b;a.labels.east=e}catch(f){throw a.exception(f),f;}};a.paintCell=function(b){try{b.areas==a.cell.label?a.paintLabelCell(b):b.areas==a.cell.aside?a.paintAsideCell(b):a.paintValueCell(b)}catch(e){throw a.exception(e),e;}};a.paintLabelCell=
function(b){try{b.label!=nil&&a.paintText(b.label.toString(),b),b.error&&a.display.errors&&a.paintErrorCircle(b)}catch(e){throw a.exception(e),e;}};a.paintAsideCell=function(b){try{var e=b.error?5==b.error?a.uic.error:4==b.error&&a.display.errors?a.uic.error:a.uic.text:a.uic.solved;b.label!=nil&&a.paintText(b.label.toString(),b,{color:e})}catch(f){throw a.exception(f),f;}};a.paintValueCell=function(b){try{var e=a.canvas.getContext("2d");e.fillStyle=0==b.value?0==b.color?a.uic.grid:a.uic.dark[b.color]:
0<b.value?0==b.color?a.uic.white:a.uic.light[b.color]:a.paintToImage&&a.moves.current==nil?a.uic.white:a.uic.gray;e.fillRect(b.px,b.py,a.unit.x,a.unit.y);b.label>nil&&a.paintText(b.label.toString(),b);a.paintSymbolMarkers(b);b.error&&a.display.errors&&a.paintErrorCircle(b)}catch(f){throw a.exception(f),f;}};a.paintCurrentValue=function(){try{var b=a.uie.value,e=b.getContext("2d");if(a.current.item){var f={x:0,y:0,w:b.width,h:b.height,scale:90};a.current.item.type==a.item.cell?(e.fillStyle=a.current.value==
nil?a.uic.gray:0==a.current.value?a.uic.black:a.uic.white,e.fillRect(0,0,b.width,b.height)):a.current.item.type>=a.item.line&&(e.fillStyle=a.uic.white,e.fillRect(0,0,b.width,b.height),a.current.value==nil&&a.paintText("\u2022",e,f),a.current.value==a.line.cross&&a.paintText("\u00d7",e,f),a.current.value==a.line.wall&&a.paintText("\u2013",e,f))}}catch(c){throw a.exception(c),c;}}}Pills.prototype=new Puzzle;
