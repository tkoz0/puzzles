function Patchwork(){var a=this;a.constructor();a.uis.puzzle=["Patchwork"];a.enable.vmarkers=!0;a.enable.values=!1;a.enable.currentValue=!1;a.charToValue=a.charToValue.concat(["0",nil,"-",nil,"/",nil]);a.init=function(){Object.getPrototypeOf(a).init.call(a)};a.reset2=function(){var b;try{a.cell.min=1;a.cell.max=a.size.z;a.cell.values=[];var c=0;for(b=1;b<=a.size.z;b++)a.cell.values[c++]=b.toString();a.cell.values[c++]=nil;c=a.size.z;a.keypadValues=a.keypad.numbers.slice(0,c);a.keypadValues[c++]=["\u2022",
nil];a.infoText=a.uis.get("numbers")+": 1~"+a.size.z;a.level.areas&&a.reset2areas(0,0,a.size.x,a.size.y,a.level.areas);if(a.level.problem){b=0;var d=a.level.problem.replace(/\s+/g," ").trim().split(" ");for(var e=0;e<a.size.y;e++)for(var f=0;f<a.size.x;f++){var h=a.board.c[f][e];var g=d[b++];"."==g||"-"==g?h.value=nil:(h.value=parseInt(g),h.fixed=!0)}}if(a.level.solution)for(b=0,d=a.level.solution.replace(/\s+/g," ").trim().split(" "),e=0;e<a.size.y;e++)for(f=0;f<a.size.x;f++)h=a.board.c[f][e],g=
d[b++],h.solution="."==g||"-"==g?nil:parseInt(g)}catch(k){throw a.exception(k),k;}};a.check2=function(){try{for(var b=0;b<a.size.x;b++)for(var c=0;c<a.size.y;c++){var d=a.board.c[b][c];c<a.size.y-1&&d.value==a.board.c[b][c+1].value&&(d.error=a.board.c[b][c+1].error=3);b<a.size.x-1&&d.value==a.board.c[b+1][c].value&&(d.error=a.board.c[b+1][c].error=3)}for(b=0;b<a.size.x;b++){var e=[];for(c=0;c<a.size.y;c++)d=a.board.c[b][c],d.value!=nil&&(e[d.value]=e[d.value]?e[d.value]+1:1);for(var f=1;f<=a.size.z;f++)if(e[f]!=
a.size.x/a.size.z)for(c=0;c<a.size.y;c++)d=a.board.c[b][c],d.value==f&&(d.error=4)}for(c=0;c<a.size.y;c++){e=[];for(b=0;b<a.size.x;b++)d=a.board.c[b][c],d.value!=nil&&(e[d.value]=e[d.value]?e[d.value]+1:1);for(f=1;f<=a.size.z;f++)if(e[f]!=a.size.y/a.size.z)for(b=0;b<a.size.x;b++)d=a.board.c[b][c],d.value==f&&(d.error=4)}for(b=0;b<a.size.x;b++)for(c=0;c<a.size.y;c++)if(d=a.board.c[b][c],d.value==nil)d.error=1;else if(!d.checked){e=[];for(var h=f=0;h<a.size.x;h++)for(var g=0;g<a.size.y;g++){var k=a.board.c[h][g];
k.areas==d.areas&&(f++,k.value!=nil&&(e[k.value]?a.board.c[e[k.value][0]][e[k.value][1]].error=a.board.c[h][g].error=5:e[k.value]=[h,g],k.checked=!0))}if(f!=a.size.z)for(h=0;h<a.size.x;h++)for(g=0;g<a.size.y;g++)k=a.board.c[h][g],k.areas==d.areas&&k.value>f&&(k.error=2)}}catch(l){throw a.exception(l),l;}};a.paintCell=function(b){try{var c=a.canvas.getContext("2d");c.fillStyle=a.uic.light[b.color];c.fillRect(b.px,b.py,a.unit.x,a.unit.y);a.paintSymbolMarkers(b);a.paintValueMarkers(b);b.value!=nil&&
a.paintText(b.value.toString(),b,{color:b.fixed?a.uic.clue:a.uic.text});b.error&&a.display.errors&&(b.value==nil?a.paintErrorDot(b):a.paintErrorCircle(b))}catch(d){throw a.exception(d),d;}};a.paintCurrentValue=function(){try{var b=a.uie.value,c=b.getContext("2d");c.fillStyle=a.uic.white;c.fillRect(0,0,b.width,b.height);c.strokeStyle=a.uic.text;c.fillStyle=a.uic.none;a.current.value!=nil&&a.paintText(a.current.value.toString(),c,{x:0,y:0,w:b.width,h:b.height,scale:90})}catch(d){throw a.exception(d),
d;}}}Patchwork.prototype=new Puzzle;
