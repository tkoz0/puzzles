function Gappy(){var a=this;a.constructor();a.uis.puzzle=["Gappy"];var f=a.board.c,k=1,l=1,m=0,n=0,q=nil,r=[-1,-1,-1,0,1,1,1,0],t=[-1,0,1,-1,-1,0,1,1];a.charToValue=a.charToValue.concat(["a",0,"s",1,"d",nil,"x",0,"c",1,"v",nil,",",0,".",1,"-",nil,"/",nil]);a.cell.values=[0,1,q];a.enable.dragging=!0;a.enable.pgrid=!0;a.keypad.left=nil;a.cell.nilalias=1;a.labels.north=a.labels.west=1;a.init=function(){Object.getPrototypeOf(a).init.call(a)};a.reset2=function(){try{k=a.labels.west;l=a.labels.north;m=
a.size.x-a.labels.east;n=a.size.y-a.labels.south;if(a.level.problem){var b=0;var c=a.level.problem.replace(/\s+/g," ").trim().split(" ");for(var e=l;e<n;e++)for(var d=k;d<m;d++){var h=f[d][e];var g=c[b++];"."==g||"-"==g?h.value=nil:"x"==g?h.value=0:"o"==g&&(h.value=1);h.value!=nil&&(h.fixed=!0)}}if(a.level.solution)for(b=0,c=a.level.solution.replace(/\s+/g," ").trim().split(" "),e=l;e<n;e++)for(d=k;d<m;d++)h=f[d][e],g=c[b++],h.solution="x"==g?0:1;if(a.level.clabels)for(b=0,c=a.level.clabels.replace(/\s+/g,
" ").trim().split(" "),d=k;d<m;d++)h=f[d][0],g=c[b++],h.label="-"==g||"."==g?nil:parseInt(g);if(a.level.rlabels)for(b=0,c=a.level.rlabels.replace(/\s+/g," ").trim().split(" "),e=l;e<n;e++)h=f[0][e],g=c[b++],h.label="-"==g||"."==g?nil:parseInt(g);a.reset2labels()}catch(p){throw a.exception(p),p;}};a.check2=function(){try{for(var b=l;b<n;b++){var c=0;for(var e=[],d=k;d<m;d++)0==f[d][b].value&&(c++,3>c&&(e[c]=d));if(2!=c){for(d=k;d<m;d++)0==f[d][b].value&&(f[d][b].error=2);f[0][b].error=2}else f[0][b].label!=
nil&&f[0][b].label!=e[2]-e[1]-1&&(f[0][b].error=4)}for(d=k;d<m;++d){c=0;e=[];for(b=l;b<n;++b)0==f[d][b].value&&(c++,3>c&&(e[c]=b));if(2!=c){for(b=l;b<n;++b)0==f[d][b].value&&(f[d][b].error=2);f[d][0].error=2}else f[d][0].label!=nil&&f[d][0].label!=e[2]-e[1]-1&&(f[d][0].error=4)}for(d=k;d<m;d++)for(b=l;b<n;b++)if(0==f[d][b].value)for(c=0;8>c;c++){var h=d+r[c],g=b+t[c];h>=k&&h<m&&g>=l&&g<n&&0==f[h][g].value&&(f[d][b].error=f[h][g].error=3)}}catch(p){throw a.exception(p),p;}};a.cleanSolution=function(){for(var a=
k;a<m;a++)for(var c=l;c<n;c++){var e=f[a][c];e.value==nil&&(e.value=1)}};a.valueToString=function(a,c){switch(a){case nil:return"-";case 0:return"x";case 1:return c?".":"-";default:return"%"}};a.paintCell=function(b){try{b.areas==a.cell.label?a.paintLabelCell(b):a.paintValueCell(b)}catch(c){throw a.exception(c),c;}};a.paintLabelCell=function(b){try{var c=a.canvas.getContext("2d");c.fillStyle=a.uic.label;c.fillRect(b.px,b.py,a.unit.x,a.unit.y);b.label!=nil&&a.paintText(b.label.toString(),b);b.error&&
a.display.errors&&a.paintErrorCircle(b)}catch(e){throw a.exception(e),e;}};a.paintValueCell=function(b){try{var c=a.canvas.getContext("2d");c.fillStyle=b.value==nil?a.paintToImage&&a.moves.current==nil?a.uic.white:a.uic.gray:0==b.value?a.uic.dark[b.color]:a.uic.light[b.color];c.fillRect(b.px,b.py,a.unit.x,a.unit.y);a.paintSymbolMarkers(b);b.error&&a.display.errors&&a.paintErrorDot(b)}catch(e){throw a.exception(e),e;}};a.paintCurrentValue=function(){try{var b=a.uie.value,c=b.getContext("2d");c.fillStyle=
a.current.value==q?a.uic.gray:0==a.current.value?a.uic.black:a.uic.white;c.fillRect(0,0,b.width,b.height)}catch(e){throw a.exception(e),e;}}}Gappy.prototype=new Puzzle;
