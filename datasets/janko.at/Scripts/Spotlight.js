function Spotlight(){var a=this;a.constructor();a.uis.puzzle=["Spotlight"];var k=a.board.c,m=0,n=0,p=nil,q=[[50,95,75,75,25,25,5],[50,95,75,75,25,25,5],[95,50,50,5,5,50,50],[5,50,50,95,95,50,50],[5,75,60,95,55,20,5],[5,20,55,95,60,75,5],[45,80,95,95,25,40,5],[25,95,95,80,45,5,40]],r=[[5,50,50,95,95,50,50],[95,50,50,5,5,50,50],[50,95,75,75,25,25,5],[50,95,75,75,25,25,5],[5,5,20,55,95,60,75],[25,40,5,45,75,95,95],[5,40,25,95,95,80,45],[5,5,75,60,95,55,20]];a.charToValue=a.charToValue.concat(["a",0,
"s",1,"d",nil,"x",0,"c",1,"v",nil,",",0,".",1,"-",nil,"/",nil]);a.cell.values=[0,1,p];a.enable.dragging=!0;a.enable.plines=!1;a.keypad.left=nil;a.init=function(){Object.getPrototypeOf(a).init.call(a)};a.reset2=function(){try{m=a.size.x;n=a.size.y;if(a.level.problem){var e=0;var d=a.level.problem.replace(/\s+/g," ").trim().split(" ");for(var c=0;c<n;c++)for(var g=0;g<m;g++){var h=k[g][c];var b=d[e++];for(var f=0;0<b.length&&"0"<=b.charAt(0)&&"9">=b.charAt(0);)f=10*f+parseInt(b.charAt(0)),b=b.substring(1);
h.label=f;h.clues="n"==b?0:"s"==b?1:"e"==b||"o"==b?2:"w"==b?3:"nw"==b?4:"sw"==b?5:"se"==b||"so"==b?6:"ne"==b||"no"==b?7:nil}}if(a.level.solution)for(e=0,d=a.level.solution.replace(/\s+/g," ").trim().split(" "),c=0;c<n;c++)for(g=0;g<m;g++)h=k[g][c],b=d[e++],h.solution="x"==b?1:0}catch(l){throw a.exception(l),l;}};a.check2=function(){try{for(var e=0,d=0;d<m;d++)for(var c=0;c<n;c++){var g=k[d][c];if(g.label!=nil){g.value==nil&&(g.error=1);1==g.value&&e++;var h=0;switch(g.clues){case 3:for(var b=d-1;0<=
b;b--)1==k[b][c].value&&h++;break;case 2:for(b=d+1;b<m;b++)1==k[b][c].value&&h++;break;case 0:for(var f=c-1;0<=f;f--)1==k[d][f].value&&h++;break;case 1:for(f=c+1;f<n;f++)1==k[d][f].value&&h++;break;case 4:b=d-1;for(f=c-1;0<=b&&0<=f;)1==k[b--][f--].value&&h++;break;case 7:b=d+1;for(f=c-1;b<m&&0<=f;)1==k[b++][f--].value&&h++;break;case 5:b=d-1;for(f=c+1;0<=b&&f<n;)1==k[b--][f++].value&&h++;break;case 6:for(b=d+1,f=c+1;b<m&&f<n;)1==k[b++][f++].value&&h++}1==g.value&&g.label!=h&&(g.error=2);0==g.value&&
g.label==h&&(g.error=2)}}0==e&&(a.solved=!1)}catch(l){throw a.exception(l),l;}};a.valueToString=function(a,d){switch(a){case nil:return"-";case 1:return"x";case 0:return d?".":"-";default:return"%"}};a.cluesToString=function(a){switch(a){case 0:return"n";case 1:return"s";case 2:return"e";case 3:return"w";case 4:return"nw";case 5:return"sw";case 6:return"se";case 7:return"ne";default:return"-"}};a.paintCell=function(e){try{var d=a.canvas.getContext("2d");d.fillStyle=e.value==nil?a.paintToImage&&a.moves.current==
nil?a.uic.white:a.uic.gray:1==e.value?a.uic.light[e.color]:e.error&&a.display.errors?a.uic.error:a.uic.dark[e.color];d.strokeStyle=e.error&&a.display.errors?a.uic.error:a.uic.black;var c=Math.floor(a.unit.x/20),g=a.unit.x-c-c,h=e.px+c,b=e.py+c;d.lineWidth=1;d.beginPath();d.moveTo(h+q[e.clues][6]*g/100,b+r[e.clues][6]*g/100);for(var f=0;7>f;f++)d.lineTo(h+q[e.clues][f]*g/100,b+r[e.clues][f]*g/100);d.fill();d.stroke();e.label!=nil&&a.paintText(e.label.toString(),d,{x:h,y:b,w:a.unit.x-c-c,h:a.unit.y-
c-c,scale:40,color:0!=e.value?a.uic.text:a.uic.text2});a.paintSymbolMarkers(e);e.error&&a.display.errors&&a.paintErrorCircle(e)}catch(l){throw a.exception(l),l;}};a.paintCurrentValue=function(){try{var e=a.uie.value,d=e.getContext("2d");d.fillStyle=a.current.value==p?a.uic.gray:0==a.current.value?a.uic.black:a.uic.white;d.fillRect(0,0,e.width,e.height)}catch(c){throw a.exception(c),c;}}}Spotlight.prototype=new Puzzle;
