function Dominos(){var a=this;a.constructor();a.uis.puzzle=["Dominoes","Dominos"];var f=a.board.c,m=a.board.h,k=a.board.v,p=0,n=0,g=0,h=0;a.line.values=[a.line.wall,a.line.cross,a.line.grid];a.enable.cells=!a.config.touch;a.enable.lines=!0;a.enable.values=!1;a.enable.dragging=!0;a.keypad.left=nil;a.labels.east=0;a.init=function(){Object.getPrototypeOf(a).init.call(a)};a.setup2=function(){try{if(a.labels.east=0,a.level.problem){for(var d=a.level.problem.replace(/\s+/g," ").trim().split(" "),c=0;c<
d.length;c++)d[c].match(/^[0-9]+$/)&&(a.labels.east=Math.max(a.labels.east,parseInt(d[c])));a.labels.east+=2}}catch(b){throw a.exception(b),b;}};a.reset2=function(){try{p=a.labels.west;n=a.labels.north;g=a.size.x-a.labels.east;h=a.size.y-a.labels.south;if(a.level.problem){var d=0;var c=a.level.problem.replace(/\s+/g," ").trim().split(" ");for(var b=n;b<h;b++)for(var e=p;e<g;e++){var q=f[e][b];var l=c[d++];q.label="-"==l||"."==l?nil:"a"<=l&&"z">=l?l.charCodeAt(0)-96:"A"<=l&&"Z">=l?l.charCodeAt(0)-
64:parseInt(l)}}if(a.level.solution){d=0;c=a.level.solution.replace(/\s+/g," ").trim().split(" ");for(b=n;b<h;b++)for(e=p;e<g;e++)q=f[e][b],l=c[d++],"."!=l&&"-"!=l&&(l.match(/^[0-9]+$/)?q.work=parseInt(l):q.work=l.charCodeAt(0)+1E3);l=1;for(e=p;e<g;e++)for(b=n;b<h;b++)if(f[e][b].work!=nil){var u=f[e][b].work;for(c=0;c<g;c++)for(d=0;d<h;d++)f[c][d].work==u&&(f[c][d].solution=l,f[c][d].work=nil);l++}for(e=1;e<g;e++)for(b=n;b<h;b++)k[e][b].solution=f[e][b].solution!=f[e-1][b].solution?a.line.wall:a.line.grid;
for(b=1;b<h;b++)for(e=p;e<g;e++)m[e][b].solution=f[e][b].solution!=f[e][b-1].solution?a.line.wall:a.line.grid}for(b=n;b<h;++b)for(e=g;e<a.size.x;++e)q=f[e][b],q.valid=!1,q.fixed=!0,q.areas=a.cell.aside;for(e=g;e<=a.size.x;e++)for(b=n;b<h;b++)k[e][b].valid=!1;for(b=n;b<=h;b++)for(e=g;e<a.size.x;e++)m[e][b].valid=!1;for(e=p;e<g;e++)m[e][0].valid=m[e][h].valid=!1,m[e][0].value=m[e][0].solution=m[e][h].value=m[e][h].solution=a.line.wall;for(b=n;b<h;b++)k[0][b].valid=k[g][b].valid=!1,k[0][b].value=k[0][b].solution=
k[g][b].value=k[g][b].solution=a.line.wall}catch(r){throw a.exception(r),r;}};a.check2=function(){try{for(var d=1,c=p;c<g;c++)for(var b=n;b<h;b++)0==f[c][b].count&&a.markArea(c,b,d++);for(var e=[],m=1;m<d;++m)e[m]=0;for(c=p;c<g;c++)for(b=n;b<h;b++)e[f[c][b].count]++;for(c=p;c<g;c++)for(b=n;b<h;b++)2!=e[f[c][b].count]&&(f[c][b].error=1);d={};for(c=p;c<g;c++)for(b=n;b<h;b++)if(!f[c][b].error&&(e=nil,c<g-1&&f[c][b].count==f[c+1][b].count&&(e=f[c+1][b].label),b<h-1&&f[c][b].count==f[c][b+1].count&&(e=
f[c][b+1].label),e!=nil)){var l=f[c][b].label;var k=Math.min(e,l).toString()+"_"+Math.max(e,l).toString();d[k]=d[k]?nil:f[c][b].count}for(c=g;c<a.size.x;c++)for(b=n;b<h;b++)if(c-g>b){var r=f[c][b];k=b.toString()+"_"+(c-g-1).toString();r.state=d[k]?d[k]==nil?1:2:0;2!=r.state&&(a.solved=!1)}}catch(t){throw a.exception(t),t;}};a.markArea=function(d,c,b){try{f[d][c].count=b,0!=d&&0==f[d-1][c].count&&k[d][c].value!=a.line.wall&&a.markArea(d-1,c,b),d!=g-1&&0==f[d+1][c].count&&k[d+1][c].value!=a.line.wall&&
a.markArea(d+1,c,b),0!=c&&0==f[d][c-1].count&&m[d][c].value!=a.line.wall&&a.markArea(d,c-1,b),c!=h-1&&0==f[d][c+1].count&&m[d][c+1].value!=a.line.wall&&a.markArea(d,c+1,b)}catch(e){throw a.exception(e),e;}};a.cleanSolution=function(){try{for(var d=n;d<h;d++)for(var c=p;c<g;c++){var b=f[c][d];b.value=b.count}}catch(e){throw a.exception(e),e;}};a.showSolution2=function(){try{for(var d=p;d<g;d++)for(var c=n;c<h;c++)f[d][c].value=nil;for(d=0;d<a.board.l.length;d++)!a.board.l[d].fixed&&a.board.l[d].valid&&
(a.board.l[d].value=a.board.l[d].solution)}catch(b){throw a.exception(b),b;}};a.showHint2=function(d){try{if(d.type!=a.item.cell)Object.getPrototypeOf(this).showHint2.call(this,d);else{for(var c=p;c<g;c++)for(var b=n;b<h;b++)f[c][b].solution==d.solution&&(f[c][b].value=nil,m[c][b].value=m[c][b].solution,m[c][b+1].value=m[c][b+1].solution,k[c][b].value=k[c][b].solution,k[c+1][b].value=k[c+1][b].solution,f[c][b].color=0,m[c][b].color=m[c][b+1].color=k[c][b].color=k[c+1][b].color=a.current.color);a.pushMove(d,
a.moves.typeHint)}}catch(e){throw a.exception(e),e;}};a.paintInit=function(){try{var d=a.size.x,c=a.labels.east;a.paintToImage&&a.solved&&(a.size.x-=a.labels.east,a.labels.east=0);Object.getPrototypeOf(this).paintInit.call(this);a.size.x=d;a.labels.east=c}catch(b){throw a.exception(b),b;}};a.paintCell=function(d){try{d.areas==a.cell.aside?a.paintAsideCell(d):a.paintValueCell(d)}catch(c){throw a.exception(c),c;}};a.paintAsideCell=function(d){try{var c=a.canvas.getContext("2d");if(d.x-g>d.y){var b=
a.uic.text;1==d.state?b=a.uic.error:2==d.state&&(b=a.uic.solved);a.paintText(d.y.toString()+":"+(d.x-g-1).toString(),c,{x:d.px,y:d.py,w:a.unit.x,h:a.unit.y,color:b,scale:40,bold:!0})}}catch(e){throw a.exception(e),e;}};a.paintValueCell=function(d){try{var c=a.canvas.getContext("2d");c.fillStyle=a.paintToImage&&a.moves.current==nil?a.uic.white:a.paintToImage&&a.solved?a.uic.light[d.count%9+1]:d.error?a.uic.white:a.uic.gray;c.fillRect(d.px,d.py,a.unit.x,a.unit.y);d.label>nil&&a.paintText(d.label.toString(),
d);a.paintSymbolMarkers(d);d.error&&a.display.errors&&a.paintErrorCircle(d)}catch(b){throw a.exception(b),b;}}}Dominos.prototype=new Puzzle;
