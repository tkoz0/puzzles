function Minesweeper(){var a=this;a.constructor();a.uis.puzzle=["Minesweeper"];a.keys=a.keys.concat(["mines"]);a.charToValue=a.charToValue.concat(["a",2,"s",1,"d",nil,".",2,",",1,"-",nil,"o",2,"x",1,"/",nil]);a.cell.values=[2,1,nil];a.enable.dragging=!0;a.keypad.left=nil;a.cell.nilalias=1;a.uic.minefill="#aaaaaa";a.uic.mineedge="#000000";a.uis.mines=["Mines","Minen","Mines","Mines"];a.enable.pgrid=!0;a.init=function(){Object.getPrototypeOf(a).init.call(a)};a.reset2=function(){try{if(a.level.problem){var c=
0;var b=a.level.problem.replace(/\s+/g," ").trim().split(" ");for(var d=0;d<a.size.y;d++)for(var e=0;e<a.size.x;e++){var f=a.board.c[e][d];var g=b[c++];"."==g||"-"==g?(f.label=nil,f.value=nil):"x"==g?(f.label=nil,f.value=1):"o"==g?(f.label=nil,f.value=2):"@"==g?(call.areas=a.cell.outside,f.fixed=!0,f.valid=!1):f.label=parseInt(g);if(f.value!=nil||f.label!=nil)f.fixed=!0}}if(a.level.solution)for(c=0,b=a.level.solution.replace(/\s+/g," ").trim().split(" "),d=0;d<a.size.y;d++)for(e=0;e<a.size.x;e++)f=
a.board.c[e][d],g=b[c++],f.solution="x"==g||"o"==g?2:1;a.level.mines&&(a.infoText=a.uis.get("mines")+": "+parseInt(a.level.mines))}catch(h){throw a.exception(h),h;}};a.check2=function(){try{for(var c=0;c<a.size.x;c++)for(var b=0;b<a.size.y;b++)if(a.board.c[c][b].label!=nil){for(var d=0,e=[0,1,1,1,0,-1,-1,-1],f=[-1,-1,0,1,1,1,0,-1],g=0;g<e.length;g++){var h=c+e[g],k=b+f[g];0<=h&&h<a.size.x&&0<=k&&k<a.size.y&&2==a.board.c[h][k].value&&d++}d!=a.board.c[c][b].label&&(a.board.c[c][b].error=2)}if(a.level.mines){for(c=
d=0;c<a.size.x;c++)for(b=0;b<a.size.y;b++)2==a.board.c[c][b].value&&d++;d!=parseInt(a.level.mines)&&(a.solved=!1)}}catch(l){throw a.exception(l),l;}};a.valueToString=function(a){return 2==a?"x":"-"};a.paintCell=function(c){try{var b=a.canvas.getContext("2d");b.fillStyle=a.uic.light[c.color];b.fillRect(c.px,c.py,a.unit.x,a.unit.y);c.label!=nil&&a.paintText(c.label.toString(),c);2==c.value?a.paintMine(c):1==c.value&&a.paintCross(c);a.paintSymbolMarkers(c);0!=c.error&&a.display.errors&&a.paintErrorCircle(c)}catch(d){throw a.exception(d),
d;}};a.paintMine=function(c,b){try{if(b=a.defaultParams(c,b)){c.px&&(c=a.canvas.getContext("2d"));b.scale||(b.scale=75);c.strokeStyle=b.stroke?b.stroke:a.uic.mineedge;c.fillStyle=b.fill?b.fill:a.uic.minefill;c.lineWidth=b.width?b.width:1;var d=b.w/2-b.w/10;c.save();c.beginPath();c.arc(b.x+b.w/2,b.y+b.h/2,d,0,2*Math.PI);c.clip();c.beginPath();c.moveTo(b.x,b.y);c.lineTo(b.x+b.w,b.y+b.h);c.moveTo(b.x+b.w,b.y);c.lineTo(b.x,b.y+b.h);c.moveTo(b.x+b.w/2,b.y);c.lineTo(b.x+b.w/2,b.y+b.h);c.moveTo(b.x,b.y+
b.h/2);c.lineTo(b.x+b.w,b.y+b.h/2);c.stroke();c.restore();d=Math.floor(b.w/2)-b.w/4;c.beginPath();c.arc(b.x+b.w/2,b.y+b.h/2,d,0,2*Math.PI);c.fill();c.beginPath();c.arc(b.x+b.w/2,b.y+b.h/2,d,0,2*Math.PI);c.stroke()}}catch(e){throw a.exception(e),e;}};a.paintCurrentValue=function(){try{var c=a.uie.value,b=c.getContext("2d");b.fillStyle=a.uic.white;b.fillRect(0,0,c.width,c.height);var d={x:0,y:0,w:c.width,h:c.height,scale:90};2==a.current.value?a.paintMine(b,d):1==a.current.value&&a.paintCross(b,d)}catch(e){throw a.exception(e),
e;}}}Minesweeper.prototype=new Puzzle;
