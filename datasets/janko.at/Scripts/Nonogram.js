function Nonogram(){var a=this;a.constructor();a.uis.puzzle=["Nonogram","Nonogramm"];var f=a.board.c,h=0,g=0,n=0,p=0,q=nil;a.charToValue=a.charToValue.concat(["a",0,"s",1,"d",nil,"x",0,"c",1,"v",nil,",",0,".",1,"-",nil,"/",nil]);a.cell.values=[0,1,q];a.enable.dragging=!0;a.enable.pgrid=!1;a.keypad.left=nil;a.init=function(){Object.getPrototypeOf(a).init.call(a)};a.setup2=function(){var b;try{if(!a.level.rlabels&&!a.level.clabels&&a.level.solution){for(var d=Array(a.size.x),c=0;c<a.size.x;c++)d[c]=
Array(a.size.y);var e=0;for(var f=a.level.solution.replace(/\s+/g," ").trim().split(" "),k=0;k<a.size.y;k++)for(c=0;c<a.size.x;c++)d[c][k]="x"==f[e]?0:1,e++;f="";for(k=0;k<a.size.y;k++){var l="";for(c=b=0;c<a.size.x;c++)0==d[c][k]?b++:0!=b&&(l+=b+" ",b=0);0!=b&&(l+=b+" ");0==l.length&&(l="0");f+=l+"\n"}a.level.rlabels=f;f="";for(c=0;c<a.size.x;c++){l="";for(k=b=0;k<a.size.y;k++)0==d[c][k]?b++:0!=b&&(l+=b+" ",b=0);0!=b&&(l+=b+" ");0==l.length&&(l="0");f+=l+"\n"}a.level.clabels=f}a.labels.north=1;var g=
a.level.clabels.trim().split("\n");for(e=0;e<g.length;e++){var h=g[e].replace(/\s+/g," ").trim().split(" ");h.length>a.labels.north&&(a.labels.north=h.length)}a.labels.west=1;g=a.level.rlabels.trim().split("\n");for(e=0;e<g.length;e++)h=g[e].replace(/\s+/g," ").trim().split(" "),h.length>a.labels.west&&(a.labels.west=h.length)}catch(t){throw a.exception(t),t;}};a.reset2=function(){try{h=a.labels.west;g=a.labels.north;n=a.size.x;p=a.size.y;if(a.level.solution){var b=0;for(var d=a.level.solution.replace(/\s+/g,
" ").trim().split(" "),c=g;c<p;c++)for(var e=h;e<n;e++){var m=f[e][c];"x"==d[b++]?m.solution=0:m.solution=1}}for(e=h;e<n;e++)for(c=g;c<p;c++)f[e][c].areas=Math.floor((e-h)/5%2)==Math.floor((c-g)/5%2)?1:2;var k=a.level.clabels.trim().split("\n");d=0;for(e=h;e<n;e++){var l=k[d++].replace(/\s+/g," ").trim().split(" ");b=g-l.length;for(c=0;c<g-b;c++)f[e][c+b].label=l[c]}k=a.level.rlabels.trim().split("\n");d=0;for(c=g;c<p;c++)for(l=k[d++].replace(/\s+/g," ").trim().split(" "),b=a.labels.west-l.length,
e=0;e<h-b;e++)f[e+b][c].label=l[e];a.reset2labels()}catch(r){throw a.exception(r),r;}};a.check2=function(){var b;try{for(var d=h;d<n;d++)for(var c=g;c<p;c++)f[d][c].value==nil&&(f[d][c].error=1);for(c=g;c<p;c++){for(b=0;b<h&&f[b][c].label==nil;)b++;var e=0;for(d=h;d<n;d++)0==f[d][c].value?b<h?e++:f[d][c].error=2:0!=e&&(e!=f[b][c].label&&(f[b][c].error=2),e=0,b++);0!=e&&(e!=f[b][c].label&&(f[b][c].error=2),e=0,b++);if(b!=h&&0!=f[b][c].label)for(var m=b;m<h;m++)f[m][c].error=2}for(d=h;d<n;d++){for(b=
0;b<g&&f[d][b].label==nil;)b++;e=0;for(c=g;c<p;c++)0==f[d][c].value?b<g?e++:f[d][c].error=2:0!=e&&(e!=f[d][b].label&&(f[d][b].error=2),e=0,b++);0!=e&&(e!=f[d][b].label&&(f[d][b].error=2),e=0,b++);if(b!=g&&0!=f[d][b].label)for(m=b;m<g;m++)f[d][m].error=2}}catch(k){throw a.exception(k),k;}};a.valueToString=function(a,d){switch(a){case nil:return"-";case 0:return"x";case 1:return d?".":"-";default:return"%"}};a.paintCell=function(b){try{b.areas==a.cell.label?a.paintLabelCell(b):a.paintValueCell(b)}catch(d){throw a.exception(d),
d;}};a.paintLabelCell=function(b){try{var d=a.canvas.getContext("2d");d.fillStyle=a.uic.label;d.fillRect(b.px,b.py,a.unit.x,a.unit.y);b.label!=nil&&a.paintText(b.label.toString(),b);b.error&&a.display.errors&&a.paintErrorCircle(b)}catch(c){throw a.exception(c),c;}};a.paintValueCell=function(b){try{var d=a.canvas.getContext("2d");d.fillStyle=b.value==nil?a.paintToImage&&a.moves.current==nil?a.uic.white:a.uic.gray:0==b.value?a.uic.dark[b.color]:a.uic.light[b.color];d.fillRect(b.px,b.py,a.unit.x,a.unit.y);
a.paintSymbolMarkers(b);b.error&&a.display.errors&&a.paintErrorDot(b)}catch(c){throw a.exception(c),c;}};a.paintCurrentValue=function(){try{var b=a.uie.value,d=b.getContext("2d");d.fillStyle=a.current.value==q?a.uic.gray:0==a.current.value?a.uic.black:a.uic.white;d.fillRect(0,0,b.width,b.height)}catch(c){throw a.exception(c),c;}}}Nonogram.prototype=new Puzzle;
