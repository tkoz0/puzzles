function MissLupun(){var a=this;a.constructor();a.uis.puzzle=["Miss Lupun"];a.enable.vmarkers=!0;a.enable.pgrid=!1;a.enable.plines=!1;a.enable.values=!1;a.enable.currentValue=!1;a.uim.padding=20;a.charToValue=a.charToValue.concat(["/",nil,"-",nil,",",nil]);a.init=function(){Object.getPrototypeOf(a).init.call(a)};a.setup2=function(){try{a.size.x=2*a.size.x-1,a.size.y=2*a.size.y-1}catch(b){throw a.exception(b),b;}};a.reset2=function(){var b;try{a.size.z=9;a.cell.min=0;a.cell.max=a.size.z;a.cell.values=
[];var c=0;for(b=0;b<=a.size.z;b++)a.cell.values[c++]=b;a.cell.values[c++]=nil;c=a.size.z;a.keypadValues=a.keypad.numbers.slice(0,c);a.keypadValues[c++]=["0",0];a.keypadValues[c++]=["\u2022",nil];if(a.level.problem){b=0;var e=a.level.problem.replace(/\s+/g," ").trim().split(" ");for(var d=0;d<a.size.y;d++)if(0==d%2)for(var f=0;f<a.size.x;f++){var g=a.board.c[f][d];var h=e[b++];0==f%2?"."==h||"-"==h?g.value=nil:(g.value=parseInt(h),g.fixed=!0):g.label="."==h||"-"==h?nil:parseInt(h)}else for(f=0;f<
Math.floor(a.size.x/2+1);f++){g=a.board.c[f][d];h=e[b++];if("."==h||"-"==h)g.label=nil;else{var k=h.charAt(0);g.clues="+"==k?"+":"-"==k?"-":"*"==k||"x"==k?"-":":"==k||"/"==k||"\u00f7"==k?":":0;0!=g.clues&&(h=h.substring(1))}g.label=parseInt(h)}}if(a.level.solution)for(b=0,e=a.level.solution.replace(/\s+/g," ").trim().split(" "),d=0;d<a.size.y;d+=2)for(f=0;f<a.size.x;f+=2)g=a.board.c[f][d],h=e[b++],g.solution="."==h||"-"==h?nil:parseInt(h);for(d=0;d<a.size.y;d++)for(f=0;f<a.size.x;f++)if(1==d%2||1==
f%2)a.board.c[f][d].valid=!1}catch(m){throw a.exception(m),m;}};var l=!1;a.check2=function(){try{for(var b=0;b<a.size.x;b+=2)for(var c=0;c<a.size.y;c+=2)a.board.c[b][c].value==nil&&(a.board.c[b][c].error=1);for(b=1;b<a.size.x;b+=2)for(c=0;c<a.size.y;c+=2){var e=a.board.c[b][c],d=a.board.c[b-1][c],f=a.board.c[b+1][c];e.label!=nil&&d.value-f.value!=e.label&&f.value-d.value!=e.label&&(e.error=2)}for(c=1;c<a.size.y-1;c+=2){e=[];for(d=0;d<Math.floor(a.size.x/2)+1;d++)e[d]=d;l=!1;a.checkSolution3(e,Math.floor(a.size.x/
2)+1,c);if(!l)for(b=0;b<Math.floor(a.size.x/2)+1;b++)a.board.c[b][c].error=3}}catch(g){throw a.exception(g),g;}};a.checkSolution3=function(b,c,e){if(1==c){c=!1;for(var d=0;d<Math.floor(a.size.x/2)+1;d++){var f=a.board.c[2*d][e-1].value,g=a.board.c[2*d][e+1].value,h=a.board.c[b[d]][e].label;switch(a.board.c[b[d]][e].clues){case "-":f-h!=g&&(c=!0);break;case "x":f*h!=g&&(c=!0);break;case ":":f/h!=g&&(c=!0);break;default:f+h!=g&&(c=!0)}}c||(l=!0)}else for(d=0;d<c;d++)a.swap(b,d,c-1),a.checkSolution3(b,
c-1,e),a.swap(b,d,c-1)};a.swap=function(a,c,e){var b=a[c];a[c]=a[e];a[e]=b};a.solutionToString=function(b){try{for(var c="solution\n",e=0;e<a.size.y;e+=2){for(var d=0;d<a.size.x;d+=2){var f=a.board.c[d][e];c+=a.valueToString(b?f.solution:f.value)+" "}c=c.rtrim()+"\n"}return c+"end\n"}catch(g){throw a.exception(g),g;}};a.paintCell=function(b){try{var c=a.canvas.getContext("2d");if(0==b.x%2&&0==b.y%2){var e=a.uim.edge+1,d=e+e;c.fillStyle=a.uic.light[b.color];c.fillRect(b.px-2,b.py-2,a.unit.x+5,a.unit.y+
5);c.beginPath();c.lineWidth=a.uim.edge;c.strokeStyle=a.uic.edge;c.lineCap="round";c.rect(b.px-e+.5,b.py-e+.5,a.unit.x+d,a.unit.y+d);c.stroke();a.paintSymbolMarkers(b);a.paintValueMarkers(b);b.value!=nil&&a.paintText(b.value.toString(),b,{color:b.fixed?a.uic.clue:a.uic.text});b.error&&a.display.errors&&(b.value==nil?a.paintErrorDot(b):a.paintErrorCircle(b))}0==b.y%2&&1==b.x%2&&(b.label!=nil&&a.paintText(b.label.toString(),b),b.error&&a.display.errors&&a.paintErrorCircle(b));if(1==b.y%2&&0==b.x){e=
"";for(d=0;d<Math.floor(a.size.x/2)+1;d++){switch(a.board.c[d][b.y].clues){case "+":e+="+";break;case "-":e+="-";break;case "x":e+="x";break;case ":":e+=":"}e+=" "+parseInt(a.board.c[d][b.y].label)+"   "}e=e.trim();a.paintText(e,c,{x:a.unit.x*a.size.x/2,y:b.py,w:a.unit.x,h:a.unit.y,scale:40,color:b.error&&a.display.errors?a.uic.error:a.uic.black})}}catch(f){throw a.exception(f),f;}};a.paintCursor=function(b,c){try{if(b){var e=1+a.uim.edge;c=e+e;var d=a.canvas.getContext("2d");d.beginPath();d.lineWidth=
a.uim.edge;d.strokeStyle=a.uic.cursor;d.lineCap="round";d.rect(b.px-e+.5,b.py-e+.5,a.unit.x+c,a.unit.y+c);d.stroke()}else Object.getPrototypeOf(this).paintCursor.call(this,b,c)}catch(f){throw a.exception(f),f;}}}MissLupun.prototype=new Puzzle;
