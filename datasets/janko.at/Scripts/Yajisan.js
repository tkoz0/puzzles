function Yajisan(){var a=this;a.constructor();a.uis.puzzle=["Yajisan-Kazusan"];var g=a.board.c,k=0,l=0,q=nil;a.charToValue=a.charToValue.concat(["a",0,"s",1,"d",nil,"x",0,"c",1,"v",nil,",",0,".",1,"-",nil,"/",nil]);a.cell.values=[0,1,q];a.enable.dragging=!0;a.enable.pgrid=!0;a.keypad.left=nil;a.cell.nilalias=1;a.init=function(){Object.getPrototypeOf(a).init.call(a)};a.reset2=function(){try{k=a.size.x;l=a.size.y;if(a.level.problem){var b=0;var c=a.level.problem.replace(/\s+/g," ").trim().split(" ");
for(var d=0;d<l;d++)for(var f=0;f<k;f++){var e=g[f][d];var h=c[b++];if("."==h||"-"==h)e.label=nil,e.clues=nil;else{var m=parseInt(h.substr(0,h.length-1)),n=h.substr(h.length-1);e.label=parseInt(m);"n"==n?e.clues=8:"s"==n?e.clues=2:"e"==n?e.clues=1:"w"==n?e.clues=4:e.label=parseInt(h)}}}if(a.level.solution)for(b=0,c=a.level.solution.replace(/\s+/g," ").trim().split(" "),d=0;d<l;d++)for(f=0;f<k;f++)e=g[f][d],h=c[b++],e.solution="x"==h?0:1}catch(p){throw a.exception(p),p;}};a.check2=function(){try{for(var b=
0;b<k;b++)for(var c=0;c<l;c++)g[b][c].value==nil&&(g[b][c].error=1);for(b=0;b<k;b++)for(c=0;c<l;c++)0==g[b][c].value&&(b<k-1&&0==g[b+1][c].value&&(g[b][c].error=3,g[b+1][c].error=3),c<l-1&&0==g[b][c+1].value&&(g[b][c].error=3,g[b][c+1].error=3));for(b=0;b<k;b++)for(c=0;c<l;c++){var d=g[b][c];if(d.label!=nil&&0!=d.value){for(var f=0,e=c-1;0<=e;e--)0==g[b][e].value&&f++;var h=0;for(e=c+1;e!=l;e++)0==g[b][e].value&&h++;e=0;for(var m=b+1;m!=k;m++)0==g[m][c].value&&e++;var n=0;for(m=b-1;0<=m;m--)0==g[m][c].value&&
n++;switch(d.clues){case 8:f!=d.label&&(d.error=2);break;case 2:h!=d.label&&(d.error=2);break;case 4:n!=d.label&&(d.error=2);break;case 1:e!=d.label&&(d.error=2)}}}f=1;a.cell.nilalias=nil;for(b=0;b<k;b++)for(c=0;c<l;c++)d=g[b][c],1==d.value&&0==d.count&&a.markArea(d,f++);a.cell.nilalias=1;2!=f&&(a.solved=!1)}catch(p){throw a.exception(p),p;}};a.valueToString=function(a,c){switch(a){case nil:return"-";case 0:return"x";case 1:return c?".":"-";default:return"%"}};a.paintCell=function(b){try{var c=a.canvas.getContext("2d");
if(b.value==nil)c.fillStyle=a.paintToImage&&a.moves.current==nil?a.uic.white:a.uic.gray;else if(0==b.value)c.fillStyle=a.uic.dark[b.color];else if(!a.solved&&a.display.errors){var d=(b.count-1)%10;c.fillStyle=0==d?a.uic.gray:a.uic.light[d]}else c.fillStyle=a.uic.light[b.color];c.fillRect(b.px,b.py,a.unit.x,a.unit.y);if(b.label!=nil){var f=a.uic.black;f=b.error&&a.display.errors?a.uic.error:0!=b.value?a.uic.text:a.uic.text2;a.paintText(parseInt(b.label),b,{x:b.px,w:8==b.clues||2==b.clues?5*a.unit.x/
6:a.unit.x,y:1==b.clues||4==b.clues?b.py+a.unit.y/6:b.py,h:a.unit.y,color:f,scale:60});a.paintArrow(b,{arrow:b.clues,shift:!0,fill:f,stroke:f})}a.paintSymbolMarkers(b);b.error&&a.display.errors&&b.label==nil&&a.paintErrorDot(b)}catch(e){throw a.exception(e),e;}};a.paintCurrentValue=function(){try{var b=a.uie.value,c=b.getContext("2d");c.fillStyle=a.current.value==q?a.uic.gray:0==a.current.value?a.uic.black:a.uic.white;c.fillRect(0,0,b.width,b.height)}catch(d){throw a.exception(d),d;}}}
Yajisan.prototype=new Puzzle;
