function ChessPlace(){var a=this;a.constructor();a.uis.puzzle=["Chess Place","Detekticschach"];var k=a.board.c,m=0,p=0,l=0,n=0,q=[0,0,0,0,0,0],r=[[1,0,-1,0,1,-1,1,-1],[1,0,-1,0,1,-1,1,-1],[1,0,-1,0],[1,-1,1,-1],[1,1,-1,-1,2,-2,2,-2],[1,-1]],t=[[0,1,0,-1,1,1,-1,-1],[0,1,0,-1,1,1,-1,-1],[0,1,0,-1],[1,1,-1,-1],[2,-2,2,-2,1,1,-1,-1],[-1,-1]],v=[1,100,100,100,1,1],h=[];h[0]=new Image;h[0].src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAnUlEQVRIie2USw7AIAhEe/9L05UuEAIz+GvSSdgY4DFKfJ4PSk5BWxyBHoVv1//Ge6AisgTuuerQJgNMDWQBh3DAUcRQSxlwVAdDdZPoDIGHxRaIqaPB2gFRcxEYbcQMSi8YCo6gMDybk4G6cNUg9bmg0AE+ISBRm+vcDqzho8iEyqcEu57htoORBTNya26LUQeD1zzvnVc6rQ5xv16n4ew+i5q0lgAAAABJRU5ErkJggg==";
h[1]=new Image;h[1].src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAvElEQVRIidWTXQ6AMAiDvf+puBm+OGOWsrXg30h4YawfnbhtC4Yf+Qn0MXgk7i3QWXUgbwAgFDke3YkhokhYI4bVmydgyUTGmVoPGYwz+qlFnSmgAp4uG3tpuNXkkHMI+F/dzNzMqN47wH6tdZB+gdYAo0YIYWsstHeIBJ2sIS0aXE4JzMCR4wGUAp/wHsIGGIKOFHAwQA4MHKifQQMjscQzS+C064pb6LrgOAf+3HEha9DXl+ttx9Uh/hs75ZcXmKg62joAAAAASUVORK5CYII=";h[2]=new Image;h[2].src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAaElEQVRIie3VwQoAIAgD0P7/p+0QBFGQrpUYDjwFPdyhSsm0yGJOzwLAIrK6yHoWDEZzBJPGnKE6YFMInfAXmzJwWraV30ATTvhjWDkuKP/V0oSFu/xMHUYSDmZUDFXuCzMSa2MP+EkqoTUy+BDkyiYAAAAASUVORK5CYII=";
h[3]=new Image;h[3].src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAkUlEQVRIieXU3Q6AIAgF4PP+L013zkwRjQP9sLm2ln0JZwEvK6lWChqKCwARkZ/BeMCcw8GwU5fZtsXEhygT76Kje554CnwB0AkWA1cDxZx1GqziTDQVLrhxuVcKCtj+XP7owuKgk1B9K1yzD6DVqd319S5uamU9V2XG5q6o4dHCtPr89ombF+zs2W635774OgCHzIuRHQ/S/AAAAABJRU5ErkJggg==";h[4]=new Image;h[4].src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAArUlEQVRIidXU3Q6AIAgGUN//pemmNkP+P2zG5kVOOTBcYxwYdK/ofjvMIWlvOy6tfTARvTD+vaOIJfkcCg4XoIIz7BRShyXACwRPYx24+qAAvAZ/1XVqtl5xUbj8kNCuU3D0vAe3dyvAIh6GWaLsnRXOgh2wmUjAyu8hDBvz6YONC+Jo2jt+EmqHsyjL5eMWmoWdRpbkbWgUtoopoTCMRAWG0V/B6q8SWGfDW+ICiBvMep52om4AAAAASUVORK5CYII=";
h[5]=new Image;h[5].src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAe0lEQVRIie3TUQ6AIAwD0B59R9vN6pd+AIo6Vo3SZL+8NWTAzLmwGB1qZjQzGU4AdHeucXcJTgAs82m4wqXoDpyGV6gCb4KKv56wDO7iWegGt3A8cVKZaPl4r/GQJQ7BEwvE0KuJ4rfQBq5pG20dQiOtJ/wTeOC8H07PAuEEsgAUQTPeAAAAAElFTkSuQmCC";a.charToValue=a.charToValue.concat(["k",0,"q",1,"d",1,"r",2,"t",2,"i",3,"l",3,"n",4,"s",4,"p",5,"b",5,"-",nil,"/",nil]);a.valueToMarker=[0,a.marker.letterBase+10,1,a.marker.letterBase+3,2,a.marker.letterBase+19,3,
a.marker.letterBase+11,4,a.marker.letterBase+18,5,a.marker.letterBase+1];a.keypadValues=[["K",0],["D",1],["T",2],["L",3],["S",4],["B",5],["\u2022",nil]];a.cell.values=[0,1,2,3,4,5,nil];a.enable.pgrid=!1;a.enable.values=!1;a.enable.currentValue=!1;a.enable.vmarkers=!0;a.labels.east=3;a.keypad.left=nil;a.keypad.right=a.keypad.values;a.keys=a.keys.concat(["pieces"]);a.uic.bsquare="#cccccc";a.uic.wsquare="#ffffff";a.init=function(){Object.getPrototypeOf(a).init.call(a)};a.reset2=function(){try{m=a.labels.west;
p=a.labels.north;l=a.size.x-a.labels.east;n=a.size.y-a.labels.south;if(a.level.problem){var b=0;var e=a.level.problem.replace(/\s+/g," ").trim().split(" ");for(var c=p;c<n;c++)for(var g=m;g<l;g++){var f=k[g][c];var d=e[b++];"."!=d&&"-"!=d&&("k"==d||"K"==d?f.value=0:"q"==d||"Q"==d?f.value=1:"r"==d||"R"==d?f.value=2:"b"==d||"B"==d?f.value=3:"n"==d||"N"==d?f.value=4:"p"==d||"P"==d?f.value=5:f.label="x"==d||"X"==d?-2:parseInt(d));-2!=f.label&&(f.fixed=!0)}}if(a.level.solution)for(b=0,e=a.level.solution.replace(/\s+/g,
" ").trim().split(" "),c=p;c<n;c++)for(g=m;g<l;g++)if(f=k[g][c],d=e[b++],"."!=d&&"-"!=d)if("k"==d||"K"==d)f.solution=0;else if("q"==d||"Q"==d)f.solution=1;else if("r"==d||"R"==d)f.solution=2;else if("b"==d||"B"==d)f.solution=3;else if("n"==d||"N"==d)f.solution=4;else if("p"==d||"P"==d)f.solution=5;if(a.level.pieces)for(e=a.level.pieces.replace(/\s+/g," ").trim().split(" "),b=0;b<e.length;b++){d=nil;switch(e[b].charAt(0)){case "k":case "K":d=0;break;case "q":case "Q":d=1;break;case "r":case "R":d=
2;break;case "b":case "B":d=3;break;case "n":case "N":d=4;break;case "p":case "P":d=5}var h=1;1<e[b].length&&(h=parseInt(e[b].substring(1)));q[d]=h}for(c=0;5>c;c++)k[l+1][c].label=q[c],k[l+2][c].label=c;for(g=l;g<a.size.x;g++)for(c=m;c<a.size.y;c++)f=k[g][c],f.valid=!1,f.fixed=!0,f.areas=a.cell.aside}catch(u){throw a.exception(u),u;}};a.check2=function(){try{a.countThreats();for(var b=m;b<l;b++)for(var e=p;e<n;e++){var c=k[b][e];c.label!=nil&&-2!=c.label&&c.count!=c.label&&(k[b][e].error=1)}var g=
[0,0,0,0,0,0];for(b=m;b<l;b++)for(e=p;e<n;e++)c=k[b][e],c.value!=nil&&g[c.value]++;for(c=0;5>c;c++)g[c]!=q[c]&&(k[l+2][c].error=2)}catch(f){throw a.exception(f),f;}};a.countThreats=function(){for(var a=m;a<l;a++)for(var e=p;e<n;e++)if(k[a][e].value!=nil)for(var c=k[a][e],g=0;g<r[c.value].length;g++)for(var f=a+r[c.value][g],d=e+t[c.value][g],h=0;h<v[c.value]&&!(0>f||f>=l||0>d||d>=n);h++){k[f][d].count++;if(-2==k[f][d].label)break;f+=r[c.value][g];d+=t[c.value][g]}};a.valueToString=function(a,e){switch(a){case 0:return"k";
case 1:return"q";case 2:return"r";case 3:return"b";case 4:return"n";case 5:return"p";default:return"-"}};a.labelToString=function(b,e){try{return-2==b?"x":a.numberToString(b)}catch(c){return ojdebug(c.toString()),"%"}};a.paintInit=function(){try{var b=a.size.x,e=a.labels.east;a.paintToImage&&a.solved&&(a.size.x-=a.labels.east,a.labels.east=0);Object.getPrototypeOf(this).paintInit.call(this);a.size.x=b;a.labels.east=e}catch(c){throw a.exception(c),c;}};a.paintCell=function(b){try{b.areas==a.cell.aside?
a.paintAsideCell(b):a.paintValueCell(b)}catch(e){throw a.exception(e),e;}};a.paintAsideCell=function(b){try{if(b.label!=nil){if(b.x==l+1)a.paintText(b.label.toString()+"\u00d7",b,{scale:50});else if(b.x==l+2){var e=a.canvas.getContext("2d"),c=h[b.label];e.drawImage(c,b.px+(a.unit.x-c.width)/2,b.py+(a.unit.y-c.height)/2)}b.error&&a.display.errors&&a.paintErrorCircle(b)}}catch(g){throw a.exception(g),g;}};a.paintValueCell=function(b){try{var e=a.canvas.getContext("2d");e.fillStyle=0==b.x%2&&0!=b.y%
2||0==b.y%2&&0!=b.x%2?a.uic.bsquare:a.uic.wsquare;e.fillRect(b.px,b.py,a.unit.x,a.unit.y);-2==b.label?a.paintSquare(b,{stroke:a.uic.black,width:2,scale:90}):b.label!=nil&&a.paintText(b.label.toString(),b);if(b.value!=nil){var c=h[b.value];e.drawImage(c,b.px+(a.unit.x-c.width)/2,b.py+(a.unit.y-c.height)/2)}a.paintSymbolMarkers(b);a.paintValueMarkers(b);b.error&&a.display.errors&&a.paintErrorCircle(b)}catch(g){throw a.exception(g),g;}}}ChessPlace.prototype=new Puzzle("proto");
