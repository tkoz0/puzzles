function Kakurasu(){var a=this;a.constructor();a.uis.puzzle=["Kakurasu"];var e=a.board.c,l=1,m=1,g=0,h=0,p=nil;a.labels.north=a.labels.south=a.labels.east=a.labels.west=1;a.charToValue=a.charToValue.concat(["a",0,"s",1,"d",nil,"x",0,"c",1,"v",nil,",",0,".",1,"-",nil,"/",nil]);a.cell.values=[0,1,p];a.enable.dragging=!0;a.enable.pgrid=!0;a.keypad.left=nil;a.cell.nilalias=1;a.init=function(){Object.getPrototypeOf(a).init.call(a)};a.reset2=function(){try{l=a.labels.west;m=a.labels.north;g=a.size.x-a.labels.east;
h=a.size.y-a.labels.south;if(a.level.clabels){var b=0;var d=a.level.clabels.replace(/\s+/g," ").trim().split(" ");for(var c=l;c<g;c++){var n=e[c][0];var k=d[b++];n.label="-"==k||"."==k?nil:parseInt(k);e[c][h].label=c}}if(a.level.rlabels){b=0;d=a.level.rlabels.replace(/\s+/g," ").trim().split(" ");for(var f=m;f<h;f++)n=e[0][f],k=d[b++],n.label="-"==k||"."==k?nil:parseInt(k),e[g][f].label=f}a.reset2labels();if(a.level.solution)for(b=0,d=a.level.solution.replace(/\s+/g," ").trim().split(" "),f=m;f<h;f++)for(c=
l;c<g;c++)n=e[c][f],k=d[b++],n.solution="x"==k?0:1;if(a.level.solution&&!a.level.rlabels&&!a.level.clabels){for(c=l;c<g;c++){e[c][0].label=0;for(f=m;f<h;f++)0==e[c][f].solution&&(e[c][0].label+=f);e[c][h].label=c}for(f=m;f<h;f++){e[0][f].label=0;for(c=l;c<g;c++)0==e[c][f].solution&&(e[0][f].label+=c);e[g][f].label=f}}}catch(q){throw a.exception(q),q;}};a.check2=function(){try{for(var b=l;b<g;b++)for(var d=m;d<h;d++)e[b][d].value==nil&&(e[b][d].error=1);for(b=l;b<g;b++)if(e[b][0].label!=nil){var c=
0;for(d=m;d<h;d++)0==e[b][d].value&&(c+=e[g][d].label);c!=e[b][0].label&&(e[b][0].error=2)}for(d=m;d<h;d++)if(e[0][d].label!=nil){c=0;for(b=l;b<g;b++)0==e[b][d].value&&(c+=e[b][h].label);c!=e[0][d].label&&(e[0][d].error=2)}}catch(n){throw a.exception(n),n;}};a.valueToString=function(a,d){switch(a){case p:return d?".":"-";case 0:return"x";case 1:return"-";default:return"%"}};a.paintCell=function(b){try{b.areas==a.cell.label?a.paintLabelCell(b):a.paintValueCell(b)}catch(d){throw a.exception(d),d;}};
a.paintLabelCell=function(b){try{var d=a.canvas.getContext("2d");d.fillStyle=a.uic.label;d.fillRect(b.px,b.py,a.unit.x,a.unit.y);b.label!=nil&&a.paintText(b.label.toString(),b);b.error&&a.display.errors&&a.paintErrorCircle(b)}catch(c){throw a.exception(c),c;}};a.paintValueCell=function(b){try{var d=a.canvas.getContext("2d");d.fillStyle=b.value==nil?a.paintToImage&&a.moves.current==nil?a.uic.white:a.uic.gray:0==b.value?a.uic.dark[b.color]:a.uic.light[b.color];d.fillRect(b.px,b.py,a.unit.x,a.unit.y);
a.paintSymbolMarkers(b);b.error&&a.display.errors&&a.paintErrorDot(b)}catch(c){throw a.exception(c),c;}};a.paintCurrentValue=function(){try{var b=a.uie.value,d=b.getContext("2d");d.fillStyle=a.current.value==p?a.uic.gray:0==a.current.value?a.uic.black:a.uic.white;d.fillRect(0,0,b.width,b.height)}catch(c){throw a.exception(c),c;}}}Kakurasu.prototype=new Puzzle;
