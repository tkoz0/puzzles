function Akari(){var c=this;c.constructor();var e=c.board.c,m=0,n=0,k=0,l=0;c.uis.puzzle=["Akari (Light Up)","Akari (Beleuchtung)"];c.charToValue=c.charToValue.concat(["a",0,"s",2,"d",nil,".",0,",",2,"-",nil,"o",0,"x",2,"/",nil]);c.cell.values=[0,2,nil];c.keypad.left=nil;c.cell.nilalias=2;c.uic.bulbfill="#ffff88";c.uic.bulbedge="#888844";c.init=function(){Object.getPrototypeOf(c).init.call(c)};c.reset2=function(){try{m=c.labels.west;n=c.labels.north;k=c.size.x-c.labels.east;l=c.size.y-c.labels.south;
c.enable.pgrid=!0;if(c.level.problem){var a=0;var b=c.level.problem.replace(/\s+/g," ").trim().split(" ");for(var d=n;d<l;d++)for(var f=m;f<k;f++){var g=e[f][d];var h=b[a++];"."!=h&&"-"!=h&&("#"==h||"x"==h?g.label=10:"/"==h?g.label=21:"\\"==h?g.label=22:"ne"==h?g.label=11:"se"==h?g.label=12:"nw"==h?g.label=13:"sw"==h?g.label=14:"o"==h?g.value=0:"@"==h?(g.areas=c.cell.outside,g.label=10,c.enable.pgrid=!1):(h.startsWith("c")&&(g.clues|=1,h=h.substring(1)),h.startsWith("s")&&(g.clues|=2,h=h.substring(1)),
g.label=parseInt(h)));if(g.value!=nil||g.label!=nil)g.fixed=!0}}if(c.level.solution)for(a=0,b=c.level.solution.replace(/\s+/g," ").trim().split(" "),d=n;d<l;d++)for(f=m;f<k;f++)g=e[f][d],h=b[a++],"-"==h||"."==h?g.solution=nil:"o"==h&&(g.solution=0)}catch(p){throw c.exception(p),p;}};c.check2=function(){try{for(var a=m;a<k;a++)for(var b=n;b<l;b++)if(0<=e[a][b].label&&4>=e[a][b].label){var d=e[a][b].label;0<a&&0==e[a-1][b].value&&d--;0<b&&0==e[a][b-1].value&&d--;a<k-1&&0==e[a+1][b].value&&d--;b<l-1&&
0==e[a][b+1].value&&d--;0!=d&&(e[a][b].error=3)}for(a=m;a<k;a++)for(b=n;b<l;b++)if(0==e[a][b].value){e[a][b].marked=!0;for(d=a-1;0<=d&&e[d][b].label==nil;d--)0==e[d][b].value?e[d][b].error=1:e[d][b].marked=!0;for(d=a+1;d<k&&e[d][b].label==nil;d++)0==e[d][b].value?e[d][b].error=1:e[d][b].marked=!0;for(d=b-1;0<=d&&e[a][d].label==nil;d--)0==e[a][d].value?e[a][d].error=1:e[a][d].marked=!0;for(d=b+1;d<l&&e[a][d].label==nil;d++)0==e[a][d].value?e[a][d].error=1:e[a][d].marked=!0}for(a=m;a<k;a++)for(b=n;b<
l;b++)e[a][b].label!=nil||e[a][b].marked||(e[a][b].error=2)}catch(f){throw c.exception(f),f;}};c.solve2=function(){try{for(var a=m;a<k;a++)for(var b=n;b<l;b++){var d=e[a][b];if(0==d.label)0<a&&e[a-1][b].label==nil&&(e[a-1][b].value=2),0<b&&e[a][b-1].label==nil&&(e[a][b-1].value=2),a<k-1&&e[a+1][b].label==nil&&(e[a+1][b].value=2),b<l-1&&e[a][b+1].label==nil&&(e[a][b+1].value=2);else if(0<d.label){var f=d.label;0<a&&e[a-1][b].label==nil&&f--;0<b&&e[a][b-1].label==nil&&f--;a<k-1&&e[a+1][b].label==nil&&
f--;b<l-1&&e[a][b+1].label==nil&&f--;0==f&&(0<a&&e[a-1][b].label==nil&&(e[a-1][b].value=0),0<b&&e[a][b-1].label==nil&&(e[a][b-1].value=0),a<k-1&&e[a+1][b].label==nil&&(e[a+1][b].value=0),b<l-1&&e[a][b+1].label==nil&&(e[a][b+1].value=0))}}}catch(g){throw c.exception(g),g;}};c.valueToString=function(a,b){switch(a){case 2:return b?"x":"-";case 0:return"o";case nil:return"-";default:return"%"}};c.labelToString=function(a,b){try{switch(a){case 10:return"x";case 11:return"ne";case 12:return"se";case 13:return"nw";
case 14:return"sw";case 21:return"/";case 22:return"\\";case nil:return"-";default:return c.numberToString(a)}}catch(d){return ojdebug(d.toString()),"%"}};c.paintCell=function(a){try{var b=c.canvas.getContext("2d");b.fillStyle=10==a.label||0<=a.label&&4>=a.label?a.error&&c.display.errors?c.uic.error:c.uic.black:c.paintToImage&&c.solved?c.uic.white:a.marked&&0==a.color?c.uic.gray:c.uic.light[a.color];b.fillRect(a.px,a.py,c.unit.x,c.unit.y);0==a.value?c.paintBulb(a):2==a.value&&c.paintCross(a);b.fillStyle=
b.strokeStyle=c.uic.black;if(21==a.label)b.beginPath(),b.lineWidth=3,b.moveTo(a.px,a.py),b.lineTo(a.px+c.unit.x,a.py+c.unit.y),b.stroke();else if(22==a.label)b.beginPath(),b.lineWidth=3,b.moveTo(a.px,a.py+c.unit.y),b.lineTo(a.px+c.unit.x,a.py),b.stroke();else if(13==a.label)b.beginPath(),b.moveTo(a.px,a.py),b.lineTo(a.px+c.unit.x,a.py),b.lineTo(a.px,a.py+c.unit.y),b.fill();else if(11==a.label)b.beginPath(),b.moveTo(a.px,a.py),b.lineTo(a.px+c.unit.x,a.py),b.lineTo(a.px+c.unit.x,a.py+c.unit.y),b.fill();
else if(12==a.label)b.beginPath(),b.lineTo(a.px+c.unit.x,a.py),b.lineTo(a.px+c.unit.x,a.py+c.unit.y),b.lineTo(a.px,a.py+c.unit.y),b.fill();else if(14==a.label)b.beginPath(),b.moveTo(a.px,a.py),b.lineTo(a.px,a.py+c.unit.y),b.lineTo(a.px+c.unit.x,a.py+c.unit.y),b.fill();else if(0<=a.label&&4>=a.label){c.paintText(a.label.toString(),a,{color:c.uic.text2});var d={stroke:c.uic.text2};0!=(a.clues&1)&&c.paintCircle(a,d);0!=(a.clues&2)&&c.paintSquare(a,d)}c.paintSymbolMarkers(a);a.error&&c.display.errors&&
a.label==nil&&(0==a.value?c.paintErrorCircle(a):c.paintErrorDot(a))}catch(f){throw c.exception(f),f;}};c.paintBulb=function(a,b){try{if(b=c.defaultParams(a,b)){a.px&&(a=c.canvas.getContext("2d"));b.scale||(b.scale=75);a.strokeStyle=b.stroke?b.stroke:c.uic.bulbedge;a.fillStyle=b.fill?b.fill:c.uic.bulbfill;a.lineWidth=b.width?b.width:1;var d=b.w/2-b.w/10;a.save();a.beginPath();a.arc(b.x+b.w/2,b.y+b.h/2,d,0,2*Math.PI);a.clip();a.beginPath();a.moveTo(b.x,b.y);a.lineTo(b.x+b.w,b.y+b.h);a.moveTo(b.x+b.w,
b.y);a.lineTo(b.x,b.y+b.h);a.moveTo(b.x+b.w/2,b.y);a.lineTo(b.x+b.w/2,b.y+b.h);a.moveTo(b.x,b.y+b.h/2);a.lineTo(b.x+b.w,b.y+b.h/2);a.stroke();a.restore();d=Math.floor(b.w/2)-b.w/4;a.beginPath();a.arc(b.x+b.w/2,b.y+b.h/2,d,0,2*Math.PI);a.fill();a.beginPath();a.arc(b.x+b.w/2,b.y+b.h/2,d,0,2*Math.PI);a.stroke()}}catch(f){throw c.exception(f),f;}};c.paintCurrentValue=function(){try{var a=c.uie.value,b=a.getContext("2d");b.fillStyle=c.uic.white;b.fillRect(0,0,a.width,a.height);var d={x:0,y:0,w:a.width,
h:a.height};0==c.current.value?c.paintBulb(b,d):2==c.current.value&&c.paintCross(b,d)}catch(f){throw c.exception(f),f;}}}Akari.prototype=new Puzzle;
