function Anglers(){var a=this;a.constructor();a.uis.puzzle=["Anglers","Angler"];var m=a.board.c,r=0,t=0,n=0,p=0,k=nil,l=nil,q={none:0,path:1,empty:2,length:3,endpoints:4};a.charToValue=a.charToValue.concat([",",nil,"x",nil,"-",nil,"/",nil,".",nil]);a.enable.dragging=!0;a.enable.values=!1;a.enable.currentValue=!1;a.keypad.left=nil;a.uic.fishfill="#aaaaaa";a.uic.fishedge="#000000";a.init=function(){Object.getPrototypeOf(a).init.call(a)};a.reset2=function(){try{r=a.labels.west;t=a.labels.north;n=a.size.x-
a.labels.east;p=a.size.y-a.labels.south;a.enable.pgrid=!0;if(a.level.problem){var b=0;var c=a.level.problem.replace(/\s+/g," ").trim().split(" ");for(var d=t;d<p;d++)for(var h=r;h<n;h++){var f=m[h][d];var g=c[b++];"."==g||"-"==g?f.label=nil:"o"==g?f.label=-2:"?"==g?f.label=0:"#"==g||"x"==g?(f.label=-3,f.fixed=!0):"@"==g?(f.areas=a.cell.outside,f.label=-3,f.fixed=!0,f.valid=!1,a.enable.pgrid=!1):f.label=parseInt(g)}}if(a.level.solution)for(b=0,c=a.level.solution.replace(/\s+/g," ").trim().split(" "),
d=t;d<p;d++)for(h=r;h<n;h++)if(f=m[h][d],g=c[b++],"-"==g||"."==g)f.solution=nil;else{var e=0;g.contains("n")&&(e|=1);g.contains("s")&&(e|=4);if(g.contains("e")||g.contains("o"))e|=2;g.contains("w")&&(e|=8);0!=e&&(f.solution=e)}}catch(u){throw a.exception(u),u;}};var e,v,w,x;a.check2=function(){try{v=0;for(var b=r;b<n;b++)for(var c=t;c<p;c++){var d=m[b][c];if(d.label>nil&&!d.checked)if(e=!1,v++,w=0,a.checkPath(d,null),e){d.error=q.path;for(var h=r;h<n;h++)for(var f=t;f<p;f++){var g=m[h][f];g.count==
v&&(g.error=q.path)}}else-2==x.label?0!=d.label&&d.label!=w&&(d.error=q.length):(d.error=q.endpoints,x.error=q.endpoints)}for(b=r;b<n;b++)for(c=t;c<p;c++)d=m[b][c],d.value==nil&&-3!=d.label&&(d.error=q.empty);for(b=r;b<n;b++)for(c=t;c<p;c++)d=m[b][c],d.value==nil||d.checked||(m[b][c].error=q.path)}catch(y){throw a.exception(y),y;}};a.checkPath=function(b,c){try{b.value==nil?e=!0:(x=b,b.checked?e=!0:(b.checked=!0,b.count=v,w++,b.label!=nil&&1!=b.value&&4!=b.value&&2!=b.value&&8!=b.value?e=!0:1!=b.value&&
4!=b.value&&2!=b.value&&8!=b.value||b.label!=nil?(c&&(b.x-1==c.x&&0==(b.value&8)&&(e=!0),b.x+1==c.x&&0==(b.value&2)&&(e=!0),b.y-1==c.y&&0==(b.value&1)&&(e=!0),b.y+1==c.y&&0==(b.value&4)&&(e=!0)),e||(0!=(b.value&8)&&(0==b.x?e=!0:(null==c||c.x!=b.x-1)&&a.checkPath(m[b.x-1][b.y],b)),0!=(b.value&2)&&(b.x==n-1?e=!0:(null==c||c.x!=b.x+1)&&a.checkPath(m[b.x+1][b.y],b)),0!=(b.value&1)&&(0==b.y?e=!0:(null==c||c.y!=b.y-1)&&a.checkPath(m[b.x][b.y-1],b)),0!=(b.value&4)&&(b.y==p-1?e=!0:(null==c||c.y!=b.y+1)&&
a.checkPath(m[b.x][b.y+1],b)))):e=!0))}catch(d){throw a.exception(d),d;}};a.dragTo2=function(b,c){try{if(!b.fixed&&b.areas!=a.cell.outside){if(b.x==c.x-1&&c.y==b.y){switch(c.value){case nil:case 16:case 0:a.makeMove(c,8);break;case 10:a.makeMove(c,10);break;case 12:a.makeMove(c,12);break;case 9:a.makeMove(c,9);break;case 1:a.makeMove(c,9);break;case 2:a.makeMove(c,10);break;case 4:a.makeMove(c,12);break;case 8:a.makeMove(c,8);break;case 5:l==c.y-1?a.makeMove(c,9):l==c.y+1?a.makeMove(c,12):a.makeMove(c,
8);break;case 3:l==c.y-1?a.makeMove(c,9):k==c.x+1?a.makeMove(c,10):a.makeMove(c,8);break;case 6:l==c.y+1?a.makeMove(c,12):k==c.x+1?a.makeMove(c,10):a.makeMove(c,8)}c.label!=nil&&a.makeMove(c,8);switch(b.value){case nil:case 16:case 0:a.makeMove(b,2);break;case 5:a.makeMove(b,2);break;case 10:a.makeMove(b,10);break;case 3:a.makeMove(b,3);break;case 6:a.makeMove(b,6);break;case 12:a.makeMove(b,2);break;case 9:a.makeMove(b,2);break;case 1:a.makeMove(b,3);break;case 2:a.makeMove(b,2);break;case 4:a.makeMove(b,
6);break;case 8:a.makeMove(b,10)}b.label!=nil&&a.makeMove(b,2)}if(b.x==c.x+1&&c.y==b.y){switch(c.value){case nil:case 16:case 0:a.makeMove(c,2);break;case 10:a.makeMove(c,10);break;case 3:a.makeMove(c,3);break;case 6:a.makeMove(c,6);break;case 1:a.makeMove(c,3);break;case 2:a.makeMove(c,2);break;case 4:a.makeMove(c,6);break;case 8:a.makeMove(c,10);break;case 5:l==c.y-1?a.makeMove(c,3):l==c.y+1?a.makeMove(c,6):a.makeMove(c,2);break;case 12:k==c.x-1?a.makeMove(c,10):l==c.y+1?a.makeMove(c,6):a.makeMove(c,
2);break;case 9:l==c.y-1?a.makeMove(c,3):k==c.x-1?a.makeMove(c,10):a.makeMove(c,2)}c.label!=nil&&a.makeMove(c,2);switch(b.value){case nil:case 16:case 0:a.makeMove(b,8);break;case 5:a.makeMove(b,8);break;case 10:a.makeMove(b,10);break;case 3:a.makeMove(b,8);break;case 6:a.makeMove(b,8);break;case 12:a.makeMove(b,12);break;case 9:a.makeMove(b,9);break;case 1:a.makeMove(b,9);break;case 2:a.makeMove(b,10);break;case 4:a.makeMove(b,12);break;case 8:a.makeMove(b,8)}b.label!=nil&&a.makeMove(b,8)}if(b.y==
c.y+1&&c.x==b.x){switch(c.value){case nil:case 16:case 0:a.makeMove(c,4);break;case 6:a.makeMove(c,6);break;case 12:a.makeMove(c,12);break;case 1:a.makeMove(c,5);break;case 2:a.makeMove(c,6);break;case 4:a.makeMove(c,4);break;case 8:a.makeMove(c,12);break;case 5:a.makeMove(c,5);break;case 10:k==c.x-1?a.makeMove(c,12):k==c.x+1?a.makeMove(c,6):a.makeMove(c,4);break;case 3:l==c.y-1?a.makeMove(c,5):k==c.x+1?a.makeMove(c,6):a.makeMove(c,4);break;case 9:k==c.x-1?a.makeMove(c,12):l==c.y-1?a.makeMove(c,5):
a.makeMove(c,4)}c.label!=nil&&a.makeMove(c,4);switch(b.value){case nil:case 16:case 0:a.makeMove(b,1);break;case 5:a.makeMove(b,5);break;case 10:a.makeMove(b,1);break;case 3:a.makeMove(b,3);break;case 6:a.makeMove(b,1);break;case 12:a.makeMove(b,1);break;case 9:a.makeMove(b,9);break;case 1:a.makeMove(b,1);break;case 2:a.makeMove(b,3);break;case 4:a.makeMove(b,5);break;case 8:a.makeMove(b,9)}b.label!=nil&&a.makeMove(b,1)}if(b.y==c.y-1&&c.x==b.x){switch(c.value){case nil:case 16:case 0:a.makeMove(c,
1);break;case 5:a.makeMove(c,5);break;case 3:a.makeMove(c,3);break;case 9:a.makeMove(c,9);break;case 1:a.makeMove(c,1);break;case 2:a.makeMove(c,3);break;case 4:a.makeMove(c,5);break;case 8:a.makeMove(c,9);break;case 10:k==c.x-1?a.makeMove(c,9):k==c.x+1?a.makeMove(c,3):a.makeMove(c,1);break;case 6:l==c.y+1?a.makeMove(c,5):k==c.x+1?a.makeMove(c,6):a.makeMove(c,4);break;case 12:k==c.x-1?a.makeMove(c,3):l==c.y+1?a.makeMove(c,5):a.makeMove(c,4)}c.label!=nil&&a.makeMove(c,1);switch(b.value){case nil:case 16:case 0:a.makeMove(b,
4);break;case 5:a.makeMove(b,5);break;case 10:a.makeMove(b,4);break;case 3:a.makeMove(b,4);break;case 6:a.makeMove(b,6);break;case 12:a.makeMove(b,12);break;case 9:a.makeMove(b,4);break;case 1:a.makeMove(b,5);break;case 2:a.makeMove(b,6);break;case 4:a.makeMove(b,4);break;case 8:a.makeMove(b,12)}b.label!=nil&&a.makeMove(b,4)}k=c.x;l=c.y;a.moveTo(b)}}catch(d){throw a.exception(d),d;}};a.dragTo2Alt=function(b,c){try{c.value!=nil&&a.makeMove(c,nil,a.current.color),b.value!=nil&&a.makeMove(b,nil,a.current.color),
a.moveTo(b)}catch(d){throw a.exception(d),d;}};a.valueToString=function(a,c){switch(a){case 16:return c?"x":"-";case 15:return"nsew";case 0:return"o";case 4:return"s";case 1:return"n";case 2:return"e";case 8:return"w";case 3:return"ne";case 9:return"nw";case 6:return"se";case 12:return"sw";case 5:return"ns";case 10:return"ew";default:return"-"}};a.paintCell=function(b){try{var c=a.canvas.getContext("2d");c.fillStyle=-3==b.label?a.uic.hole:a.uic.light[0];c.fillRect(b.px,b.py,a.unit.x,a.unit.y);if(b.value!=
nil){var d=Math.floor((a.unit.x-Math.floor(a.unit.x/4))/2),h=a.unit.x-2*d,f=h+d;c.fillStyle=0==b.color?a.uic.line:a.uic.light[b.color];16!=b.value||a.solved||a.paintCross(b);0==b.value&&c.fillRect(b.px+d,b.py+d,h,h);0!=(b.value&1)&&c.fillRect(b.px+d,b.py,h,f);0!=(b.value&4)&&c.fillRect(b.px+d,b.py+d,h,f);0!=(b.value&2)&&c.fillRect(b.px+d,b.py+d,f,h);0!=(b.value&8)&&c.fillRect(b.px,b.py+d,f,h)}a.paintSymbolMarkers(b);-2==b.label?a.paintFish(b):0==b.label?a.paintText("?",b):0<b.label&&a.paintText(b.label.toString(),
b);b.error&&a.display.errors&&(b.error==q.block?a.paintErrorSquare(b):b.label!=nil?a.paintErrorCircle(b):a.paintErrorDot(b))}catch(g){throw a.exception(g),g;}};a.paintFish=function(b,c){try{if(c=a.defaultParams(b,c)){b.px&&(b=a.canvas.getContext("2d"));b.strokeStyle=c.stroke?c.stroke:a.uic.fishedge;b.fillStyle=c.fill?c.fill:a.uic.fishfill;b.lineWidth=c.width?c.width:1;var d=[20,40,70,80,90,80,70,40,20],h=[50,30,50,40,50,60,50,70,50],f=c.w/100,g=c.h/100;b.beginPath();b.moveTo(c.x+d[0]*f,c.y+h[0]*g);
for(var e=0;e<d.length;e++)b.lineTo(c.x+d[e]*f,c.y+h[e]*g);b.lineTo(c.x+d[0]*f,c.y+h[0]*g);b.fill();b.stroke()}}catch(u){throw a.exception(u),u;}}}Anglers.prototype=new Puzzle;
