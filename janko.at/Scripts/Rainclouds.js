function Rainclouds(){var a=this;a.constructor();a.uis.puzzle=["Rain Clouds","Regenwolken"];var f=a.board.c,k=0,l=0,q=nil,v=[-1,-1,-1,0,1,1,1,0],w=[-1,0,1,-1,-1,0,1,1];a.charToValue=a.charToValue.concat(["a",0,"s",1,"d",nil,"x",0,"c",1,"v",nil,",",0,".",1,"-",nil,"/",nil]);a.cell.values=[0,1,q];a.enable.dragging=!0;a.enable.pgrid=!0;a.keypad.left=nil;a.cell.nilalias=1;a.labels.north=a.labels.west=1;a.init=function(){Object.getPrototypeOf(a).init.call(a)};a.reset2=function(){try{k=a.size.x;l=a.size.y;
if(a.level.problem){var c=0;var d=a.level.problem.replace(/\s+/g," ").trim().split(" ");for(var b=1;b<l;b++)for(var e=1;e<k;e++){var g=f[e][b];var h=d[c++];"."!=h&&"-"!=h&&("x"==h?g.value=0:"o"==h&&(g.value=1));g.value!=nil&&(g.fixed=!0)}}if(a.level.solution)for(c=0,d=a.level.solution.replace(/\s+/g," ").trim().split(" "),b=1;b<l;b++)for(e=1;e<k;e++)g=f[e][b],h=d[c++],g.solution="x"==h?0:1;if(a.level.clabels)for(c=0,d=a.level.clabels.replace(/\s+/g," ").trim().split(" "),e=1;e<k;e++)g=f[e][0],h=d[c++],
"-"!=h&&"."!=h&&(g.label=parseInt(h));if(a.level.rlabels)for(c=0,d=a.level.rlabels.replace(/\s+/g," ").trim().split(" "),b=1;b<l;b++)g=f[0][b],h=d[c++],"-"!=h&&"."!=h&&(g.label=parseInt(h));if(!a.level.cabels&&!a.level.rlabels&&a.level.solution){for(e=1;e<k;e++)for(f[e][0].label=0,b=1;b<l;b++)0==f[e][b].solution&&f[e][0].label++;for(b=1;b<l;b++)for(f[0][b].label=0,e=1;e<k;e++)0==f[e][b].solution&&f[0][b].label++}a.reset2labels()}catch(m){throw a.exception(m),m;}};a.check2=function(){var c,d;try{for(var b=
1;b<k;++b)if(f[b][0].label!=nil){var e=0;for(var g=1;g<l;++g)0==f[b][g].value&&e++;e!=f[b][0].label&&(f[b][0].error=3)}for(g=1;g<l;++g)if(f[0][g].label!=nil){e=0;for(b=1;b<k;++b)0==f[b][g].value&&e++;e!=f[0][g].label&&(f[0][g].error=3)}for(b=e=1;b<k;++b)for(g=1;g<l;++g)if(0==f[b][g].value&&0==f[b][g].count){for(var h=b,m=g,n=h;n<k&&0==f[n][m].value;)n++;for(var p=m;p<l&&0==f[h][p].value;)p++;var q=2>n-h||2>p-m;for(d=h;d<n;d++)for(c=m;c<p;c++)0==f[d][c].value?f[d][c].count=e:q=!0;if(q)for(d=h;d<n;d++)for(c=
m;c<p;c++)f[d][c].error=4;e++}for(b=1;b<k;++b)for(g=1;g<l;++g)for(e=0;8>e;e++)if(d=b+v[e],c=g+w[e],1<=d&&1<=c&&d<k&&c<l){var r=f[b][g],t=f[d][c];0!=r.count&&0!=t.count&&r.count!=t.count&&(r.error=t.error=5)}}catch(u){throw a.exception(u),u;}};a.solve2=function(){try{for(var c=1;c<k;c++)if(0==f[c][0].label)for(var d=1;d<l;d++)f[c][d].value=1;for(d=1;d<l;d++)if(0==f[0][d].label)for(c=1;c<k;c++)f[c][d].value=1}catch(b){throw a.exception(b),b;}};a.cleanSolution=function(){for(var a=1;a<k;a++)for(var d=
1;d<l;d++){var b=f[a][d];b.value==nil&&(b.value=1)}};a.valueToString=function(a,d){switch(a){case nil:return"-";case 0:return"x";case 1:return d?".":"-";default:return"%"}};a.paintCell=function(c){try{c.areas==a.cell.label?a.paintLabelCell(c):a.paintValueCell(c)}catch(d){throw a.exception(d),d;}};a.paintLabelCell=function(c){try{var d=a.canvas.getContext("2d");d.fillStyle=a.uic.label;d.fillRect(c.px,c.py,a.unit.x,a.unit.y);c.label!=nil&&a.paintText(c.label,c);c.error&&a.display.errors&&a.paintErrorCircle(c)}catch(b){throw a.exception(b),
b;}};a.paintValueCell=function(c){try{var d=a.canvas.getContext("2d");d.fillStyle=c.value==nil?a.paintToImage&&a.moves.current==nil?a.uic.white:a.uic.gray:0==c.value?a.uic.dark[c.color]:!a.solved&&a.display.errors?a.uic.light[c.count%10]:a.uic.light[c.color];d.fillRect(c.px,c.py,a.unit.x,a.unit.y);a.paintSymbolMarkers(c);c.error&&a.display.errors&&a.paintErrorDot(c)}catch(b){throw a.exception(b),b;}};a.paintCurrentValue=function(){try{var c=a.uie.value,d=c.getContext("2d");d.fillStyle=a.current.value==
q?a.uic.gray:0==a.current.value?a.uic.black:a.uic.white;d.fillRect(0,0,c.width,c.height)}catch(b){throw a.exception(b),b;}}}Rainclouds.prototype=new Puzzle;
