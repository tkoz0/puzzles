function Lighthouses(){var a=this;a.constructor();a.uis.puzzle=["Lighthouses","Leuchtt\u00fcrme"];var g=a.board.c,k=0,l=0,m=0,n=0,q=[-1,-1,0,1,1,1,0,-1],r=[0,-1,-1,-1,0,1,1,1];a.keys=a.keys.concat(["ships"]);a.charToValue=a.charToValue.concat(["a",1,"s",0,"d",nil,".",1,",",0,"-",nil,"o",1,"x",0,"/",nil]);a.cell.values=[1,0,nil];a.enable.dragging=!0;a.keypad.left=nil;a.cell.nilalias=0;a.uic.shipfill="#aaaaaa";a.uic.shipedge="#000000";a.uis.ships=["Ships","Schiffe","Navires","Navi"];a.enable.pgrid=
!0;a.init=function(){Object.getPrototypeOf(a).init.call(a)};a.reset2=function(){try{k=a.labels.west;l=a.labels.north;m=a.size.x-a.labels.east;n=a.size.y-a.labels.south;a.level.ships&&(a.infoText=a.uis.get("ships")+": "+parseInt(a.level.ships));if(a.level.problem){var b=0;var c=a.level.problem.replace(/\s+/g," ").trim().split(" ");for(var e=l;e<n;e++)for(var f=k;f<m;f++){var d=g[f][e];var h=c[b++];"."==h||"-"==h?(d.label=nil,d.value=nil):"x"==h?(d.label=nil,d.value=0):"o"==h?(d.label=nil,d.value=1):
"@"==h?(call.areas=a.cell.outside,d.fixed=!0,d.valid=!1):d.label=parseInt(h);if(d.value!=nil||d.label!=nil)d.fixed=!0}}if(a.level.solution)for(b=0,c=a.level.solution.replace(/\s+/g," ").trim().split(" "),e=l;e<n;e++)for(f=k;f<m;f++)d=g[f][e],h=c[b++],"-"==h||"."==h?d.solution=nil:"x"==h||"o"==h?d.solution=1:(d.label=parseInt(h),g[f][e].fixed=!0)}catch(p){throw a.exception(p),p;}};a.check2=function(){try{for(var b=k;b<m;b++)for(var c=l;c<n;c++)if(1==g[b][c].value||g[b][c].label!=nil)for(var e=0;8>
e;e++){var f=b+q[e];var d=c+r[e];f>=k&&f<m&&d>=l&&d<n&&(1==g[f][d].value||g[f][d].label!=nil)&&(g[f][d].error=3)}for(b=k;b<m;b++)for(c=l;c<n;c++)if(g[b][c].label!=nil){e=0;for(f=k;f<m;f++)1==g[f][c].value&&(e++,g[f][c].marked=!0);for(d=l;d<n;d++)1==g[b][d].value&&(e++,g[b][d].marked=!0);e!=g[b][c].label&&(g[b][c].error=1)}for(b=k;b<m;b++)for(c=l;c<n;c++)1!=g[b][c].value||g[b][c].marked||(g[b][c].error=2);if(a.level.ships){d=0;for(b=k;b<m;b++)for(c=l;c<n;c++)1==g[b][c].value&&d++;d!=parseInt(a.level.ships)&&
(a.solved=!1)}}catch(h){throw a.exception(h),h;}};a.solve2=function(){try{for(var b=k;b<m;++b)for(var c=l;c<n;++c)if(g[b][c].label!=nil){g[b][c].count++;for(var e=0;8>e;e++){var f=b+q[e],d=c+r[e];f>=k&&f<m&&d>=l&&d<n&&g[f][d].value==nil&&(g[f][d].value=0)}}}catch(h){throw a.exception(h),h;}};a.valueToString=function(b,a){return b==nil?"-":0==b?a?".":"-":1==b?"x":"?"};a.paintCell=function(b){try{var c=a.canvas.getContext("2d");c.fillStyle=a.uic.light[b.color];c.fillRect(b.px,b.py,a.unit.x,a.unit.y);
b.label!=nil&&a.paintText(b.label.toString(),b);1==b.value?a.paintShip(b):0==b.value&&a.paintCross(b);a.paintSymbolMarkers(b);0!=b.error&&a.display.errors&&(1==b.value?a.paintErrorSquare(b):a.paintErrorCircle(b))}catch(e){throw a.exception(e),e;}};a.paintShip=function(b,c){try{if(c=a.defaultParams(b,c)){b.px&&(b=a.canvas.getContext("2d"));var e=c.w*(100-c.scale)/200;b.strokeStyle=c.stroke?c.stroke:a.uic.shipedge;b.fillStyle=c.fill?c.fill:a.uic.shipfill;b.lineWidth=c.width?c.width:1;var f=[1,2,5,6,
3,3,4.5,3],d=[4.5,6,6,4.5,4.5,1,3.5,4.5];e=c.w/7;b.beginPath();b.moveTo(c.x+f[0]*e,c.y+d[0]*e);for(var g=0;g<f.length;g++)b.lineTo(c.x+f[g]*e,c.y+d[g]*e);b.lineTo(c.x+f[0]*e,c.y+d[0]*e);b.fill();b.stroke()}}catch(p){throw a.exception(p),p;}};a.paintCurrentValue=function(){try{var b=a.uie.value,c=b.getContext("2d");c.fillStyle=a.uic.white;c.fillRect(0,0,b.width,b.height);var e={x:0,y:0,w:b.width,h:b.height};1==a.current.value?a.paintShip(c,e):0==a.current.value&&a.paintCross(c,e)}catch(f){throw a.exception(f),
f;}}}Lighthouses.prototype=new Puzzle;
