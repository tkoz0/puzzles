function Mathrax(){var a=this;a.constructor();a.uis.puzzle=["Mathrax"];a.enable.vmarkers=!0;a.enable.pgrid=!0;a.enable.nodes=!1;a.enable.pnodes=!0;a.enable.values=!1;a.enable.currentValue=!1;a.uic.circlefill="#ffffff";a.uic.circleedge="#000000";a.charToValue=a.charToValue.concat(["0",nil,"-",nil,"/",nil]);a.init=function(){Object.getPrototypeOf(a).init.call(a)};a.reset2=function(){var b;try{a.cell.min=1;a.cell.max=a.size.z;a.cell.values=[];var c=0;for(b=1;b<=a.size.z;b++)a.cell.values[c++]=b.toString();
a.cell.values[c++]=nil;c=a.size.z;a.keypadValues=a.keypad.numbers.slice(0,c);a.keypadValues[c++]=["\u2022",nil];if(a.level.problem){b=0;var d=a.level.problem.replace(/\s+/g," ").trim().split(" ");for(var e=0;e<a.size.y;e++)for(var g=0;g<a.size.x;g++){var h=a.board.c[g][e];var f=d[b++];"."==f||"-"==f?h.value=nil:(h.value=parseInt(f),h.fixed=!0)}}if(a.level.nodes)for(b=0,d=a.level.nodes.replace(/\s+/g," ").trim().split(" "),e=1;e<a.size.y;e++)for(g=1;g<a.size.x;g++){var k=a.board.n[g][e];f=d[b++];if("."==
f||"-"==f)k.label=nil;else{switch(f.charAt(f.length-1)){case "+":k.clues=1;break;case "-":k.clues=2;break;case "x":case "*":k.clues=3;break;case ":":case "\u00f7":case "/":k.clues=4;break;case "U":case "u":case "O":case "o":k.clues=5;break;case "G":case "g":case "E":case "e":k.clues=6}0==k.clues?k.label=parseInt(f):1!=f.length&&(k.label=parseInt(f.substring(0,f.length-1)))}}if(a.level.solution)for(b=0,d=a.level.solution.replace(/\s+/g," ").trim().split(" "),e=0;e<a.size.y;e++)for(g=0;g<a.size.x;g++)h=
a.board.c[g][e],f=d[b++],h.solution="."==f||"-"==f?nil:parseInt(f)}catch(l){throw a.exception(l),l;}};a.check2=function(){try{for(var b=0;b<a.size.z;b++)a.checkLine(b,0,0,1);for(var c=0;c<a.size.z;c++)a.checkLine(0,c,1,0);for(b=1;b<a.size.x;b++)for(c=1;c<a.size.y;c++){var d=a.board.n[b][c],e=a.board.c[b-1][c-1],g=a.board.c[b][c],h=a.board.c[b-1][c],f=a.board.c[b][c-1];switch(d.clues){case 1:if(e.value+g.value!=d.label||h.value+f.value!=d.label)d.error=2;break;case 2:if(Math.abs(e.value-g.value)!=
d.label||Math.abs(h.value-f.value)!=d.label)d.error=2;break;case 3:if(e.value*g.value!=d.label||h.value*f.value!=d.label)d.error=2;break;case 4:if(e.value/g.value!=d.label&&g.value/e.value!=d.label||h.value/f.value!=d.label&&f.value/h.value!=d.label)d.error=2;break;case 5:if(0==e.value%2||0==h.value%2||0==g.value%2||0==f.value%2)d.error=2;break;case 6:if(0!=e.value%2||0!=h.value%2||0!=g.value%2||0!=f.value%2)d.error=2}}}catch(k){throw a.exception(k),k;}};a.checkLine=function(b,c,d,e){for(var g=[],
h=0;h<a.size.z;++h){var f=a.board.c[b+d*h][c+e*h];f.value==nil?f.error=1:g[f.value]?f.error=g[f.value].error=3:g[f.value]=f}};a.initValueMarkers2=function(){for(var b=0;b<a.size.x;b++)for(var c=0;c<a.size.y;c++){var d=a.board.c[b][c];if(d.value==nil)for(var e=1;e<=a.size.z;e++)d.markers.set(a.marker.numberBase+e)}};a.updateValueMarkers2=function(){for(var b=0;b<a.size.x;b++)for(var c=0;c<a.size.y;c++){var d=a.board.c[b][c];if(1>d.value){for(var e=0;e<a.size.x;e++)a.board.c[e][c].markers.clear(a.marker.numberBase+
d.value);for(e=0;e<a.size.y;e++)a.board.c[b][e].markers.clear(a.marker.numberBase+d.value)}}};a.paintCell=function(b){try{var c=a.canvas.getContext("2d");c.fillStyle=a.uic.light[b.color];c.fillRect(b.px,b.py,a.unit.x,a.unit.y);a.paintSymbolMarkers(b);a.paintValueMarkers(b);b.value!=nil&&a.paintText(b.value.toString(),b,{color:b.fixed?a.uic.clue:a.uic.text});b.error&&a.display.errors&&(b.value==nil?a.paintErrorDot(b):a.paintErrorCircle(b))}catch(d){throw a.exception(d),d;}};a.paintNode=function(b){if(b.label!=
nil||0!=b.clues){var c=a.canvas.getContext("2d"),d=a.unit.x/3;c.fillStyle=a.uic.circlefill;a.display.errors&&b.error?(c.strokeStyle=a.uic.error,c.lineWidth=2):(c.strokeStyle=a.uic.circleedge,c.lineWidth=1);c.beginPath();c.arc(b.px,b.py,d,0,2*Math.PI);c.fill();c.stroke();d=b.label==nil?"":b.label.toString();switch(b.clues){case 1:d+="+";break;case 2:d+="-";break;case 3:d+="\u00d7";break;case 4:d+="/";break;case 5:d+="O";break;case 6:d+="E"}var e=2==b.error&&a.display.errors?a.uic.error:a.uic.text;
c.textAlign="center";c.textBaseline="middle";c.font=Math.floor(a.unit.x/3).toString()+"px sans-serif";c.fillStyle=e;c.fillText(d,b.px,b.py)}}}Mathrax.prototype=new Puzzle;
