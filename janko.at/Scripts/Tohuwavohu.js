function Tohuwavohu(){var a=this;a.constructor();a.uis.puzzle=["Tohu wa Vohu"];a.charToValue=a.charToValue.concat(["t",1,"v",2,"-",nil,"/",nil]);a.cell.values=[1,2,nil];a.enable.dragging=!0;a.keypad.left=nil;a.enable.pgrid=!0;a.uic.tohu="#33cc33";a.uic.vohu="#3333cc";a.init=function(){Object.getPrototypeOf(a).init.call(a)};a.reset2=function(){try{if(a.level.problem){var e=0;var g=a.level.problem.replace(/\s+/g," ").trim().split(" ");for(var d=0;d<a.size.y;d++)for(var b=0;b<a.size.x;b++){var c=a.board.c[b][d];
var f=g[e++];if("."==f||"-"==f)c.value=nil;else if("t"==f||"1"==f)c.value=1;else if("v"==f||"2"==f)c.value=2;c.value!=nil&&(c.fixed=!0)}}if(a.level.solution)for(e=0,g=a.level.solution.replace(/\s+/g," ").trim().split(" "),d=0;d<a.size.y;d++)for(b=0;b<a.size.x;b++)if(c=a.board.c[b][d],f=g[e++],"."==f||"-"==f)c.solution=nil;else if("t"==f||"1"==f)c.solution=1;else if("v"==f||"2"==f)c.solution=2}catch(h){throw a.exception(h),h;}};a.check2=function(){var e,g,d;try{for(var b=0;b<a.size.x;b++)for(var c=
0;c<a.size.y;c++)a.board.c[b][c].value==nil&&(a.board.c[b][c].error=1);for(c=0;c<a.size.y;c++){var f=nil;for(b=d=0;b<a.size.x;b++)if(a.board.c[b][c].value==f?d++:(d=1,f=a.board.c[b][c].value),2<d&&f!=nil)for(var h=b;0<=h&&a.board.c[b][c].value==f;h--)a.board.c[h][c].error=3}for(b=0;b<a.size.x;b++)for(f=nil,c=d=0;c<a.size.y;c++)if(a.board.c[b][c].value==f?d++:(d=1,f=a.board.c[b][c].value),2<d&&f!=nil)for(h=b;0<=h&&a.board.c[b][c].value==f;h--)a.board.c[b][h].error=3;for(c=0;c<a.size.y;c++){for(b=e=
g=0;b<a.size.x;b++)1==a.board.c[b][c].value?g++:2==a.board.c[b][c].value&&e++;if(g+e==a.size.x&&g!=a.size.x/2)for(b=0;b<a.size.x;b++)a.board.c[b][c].error=2}for(b=0;b<a.size.x;b++){for(c=e=g=0;c<a.size.y;c++)1==a.board.c[b][c].value?g++:2==a.board.c[b][c].value&&e++;if(g+e==a.size.y&&g!=a.size.y/2)for(c=0;c<a.size.y;c++)a.board.c[b][c].error=2}}catch(k){throw a.exception(k),k;}};a.valueToString=function(a){return 1==a?"t":2==a?"v":"-"};a.paintCell=function(e){try{var g=a.canvas.getContext("2d");g.fillStyle=
a.uic.light[e.color];g.fillRect(e.px,e.py,a.unit.x,a.unit.y);a.paintSymbolMarkers(e);if(1==e.value){var d={fill:a.uic.none};d.color=e.fixed?a.uic.text:a.uic.tohu;d.stroke=e.error&&a.display.errors?a.uic.error:a.uic.tohu;d.scale=60;a.paintText("T",e,d);d.scale=75;a.paintCircle(e,d)}else 2==e.value&&(d={fill:a.uic.none},d.color=e.fixed?a.uic.text:a.uic.vohu,d.stroke=e.error&&a.display.errors?a.uic.error:a.uic.vohu,d.scale=60,a.paintText("V",e,d),d.scale=75,a.paintSquare(e,d));e.error&&a.display.errors&&
e.value==nil&&a.paintErrorDot(e)}catch(b){throw a.exception(b),b;}};a.paintCurrentValue=function(){try{var e=a.uie.value,g=e.getContext("2d");g.fillStyle=a.uic.white;g.fillRect(0,0,e.width,e.height);var d={x:0,y:0,w:e.width,h:e.height,scale:80};1==a.current.value?(d.stroke=a.uic.tohu,a.paintText("T",g,d)):2==a.current.value&&(d.stroke=a.uic.vohu,a.paintText("V",g,d))}catch(b){throw a.exception(b),b;}}}Tohuwavohu.prototype=new Puzzle;
