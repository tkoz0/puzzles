function Kendoku(){var a=this;a.constructor();var p=1,q=1,m=0,n=0;a.variant.killer=["killer",["Killer Sudoku"]];a.variant.kendoku=["kendoku",["Kendoku"]];a.variant.sumdoku=["sumdoku",["Sumdoku"]];a.variant.factors=["factors",["Factors"]];a.enable.vmarkers=!0;a.enable.currentValue=!1;a.uic.shade1="#ffffff";a.uic.shade2="#dddddd";a.enable.values=!1;a.enable.currentValue=!1;a.keys=a.keys.concat(["pattern","patternx","patterny"]);a.charToValue=a.charToValue.concat(["0",nil,"-",nil,"/",nil]);a.init=function(){Object.getPrototypeOf(a).init.call(a)};
a.reset2=function(){var b;try{!a.level.puzzle&&a.level.variant&&(a.level.puzzle=a.level.variant);a.variant.init(a.variant.killer);p=a.labels.west;q=a.labels.north;m=a.size.x-a.labels.east;n=a.size.y-a.labels.south;zmin=1;zmax=a.size.z;a.cell.min=1;a.cell.max=a.size.z;a.cell.values=[];var e=0;for(b=1;b<=a.size.z;b++)a.cell.values[e++]=b.toString();a.cell.values[e++]=nil;e=a.size.z;a.keypadValues=a.keypad.numbers.slice(0,e);a.keypadValues[e++]=["\u2022",nil];a.level.areas&&a.reset2areas(0,0,m,n,a.level.areas);
if(a.level.problem){b=0;var f=a.level.problem.replace(/\s+/g," ").trim().split(" ");for(var d=q;d<n;d++)for(var h=p;h<m;h++){var k=a.board.c[h][d];var c=f[b++];if("."==c||"-"==c)k.value=nil;else if(a.variant.is(a.variant.kendoku)){switch(c.charAt(c.length-1)){case "+":k.clues=1;break;case "-":k.clues=2;break;case "x":case "*":k.clues=3;break;case ":":case "\u00f7":case "/":k.clues=4}k.label=0==k.clues?parseInt(c):parseInt(c.substring(0,c.length-1))}else a.variant.is(a.variant.factors)?(k.label=parseInt(c),
k.clues=3):(k.label=parseInt(c),k.clues=1)}}if(a.level.solution)for(b=0,f=a.level.solution.replace(/\s+/g," ").trim().split(" "),d=q;d<n;d++)for(h=p;h<m;h++)k=a.board.c[h][d],c=f[b++],k.solution="."==c||"-"==c?nil:parseInt(c);a.variant.is(a.variant.killer)&&!a.level.pattern&&9==m&&9==n&&(a.level.pattern=3);a.level.pattern&&(a.level.patternx||(a.level.patternx=a.level.pattern),a.level.patterny||(a.level.patterny=a.level.pattern));if(a.level.patternx&&a.level.patterny){var g=parseInt(a.level.patternx),
r=parseInt(a.level.patterny);b=0==g%2?g+1:g;for(d=q;d<n;d++)for(h=p;h<m;h++)a.board.c[h][d].area2=Math.floor(h/g)+Math.floor(d/r)*b}}catch(t){throw a.exception(t),t;}};a.check2=function(){try{for(var b=p;b<a.size.z;b++)a.checkLine(b,0,0,1);for(var e=q;e<a.size.z;e++)a.checkLine(0,e,1,0);a.level.options.contains("diagonals")&&(a.checkLine(0,0,1,1),a.checkLine(m-1,0,-1,1));if(a.level.patternx)for(b=p;b<m;b++)for(e=q;e<n;e++){var f=a.board.c[b][e];if(!f.checked){var d=[];for(var h=p;h<m;h++)for(var k=
q;k<n;k++){var c=a.board.c[h][k];c.checked||f.area2!=c.area2||(c.checked=!0,c.value==nil?c.error=1:d[c.value]?c.error=d[c.value].error=3:d[c.value]=c)}}}for(b=p;b<m;b++)for(e=q;e<n;e++)if(f=a.board.c[b][e],!f.marked){d=[];var g=[],r=0,t=0,u=1,l=null;for(h=p;h<m;h++)for(k=q;k<n;k++)c=a.board.c[h][k],c.marked||f.areas!=c.areas||(c.marked=!0,c.value==nil?c.error=1:(d[c.value]&&a.variant.is(a.variant.killer)&&(c.error=d[c.value].error=3),t+=c.value,u*=c.value,d[c.value]=c,g[r++]=c.value,c.label!=nil&&
(l=c)));if(l)switch(l.clues){case 1:l.label!=t&&(l.error=2);break;case 3:l.label!=u&&(l.error=2);break;case 2:l.label!=g[0]-g[1]&&l.label!=g[1]-g[0]&&(l.error=2);break;case 4:l.label!=g[0]/g[1]&&l.label!=g[1]/g[0]&&(l.error=2);break;default:a.variant.is(a.variant.kendoku)?l.label!=t&&l.label!=u&&l.label!=g[0]-g[1]&&l.label!=g[1]-g[0]&&l.label!=g[0]/g[1]&&l.label!=g[1]/g[0]&&(l.error=2):l.label!=t&&(l.error=2)}}}catch(v){throw a.exception(v),v;}};a.checkLine=function(b,e,f,d){try{for(var h=[],k=0;k<
a.size.z;++k){var c=a.board.c[b+f*k][e+d*k];c.value==nil?c.error=1:h[c.value]?c.error=h[c.value].error=3:h[c.value]=c}}catch(g){throw a.exception(g),g;}};a.initValueMarkers2=function(){for(var b=p;b<m;b++)for(var e=q;e<n;e++){var f=a.board.c[b][e];if(f.value==nil)for(var d=1;d<=a.size.z;d++)f.markers.set(a.marker.numberBase+d)}};a.updateValueMarkers2=function(){for(var b=p;b<m;b++)for(var e=q;e<n;e++){var f=a.board.c[b][e];if(f.value!=nil){for(var d=p;d<m;d++)a.board.c[d][e].markers.clear(a.marker.numberBase+
f.value);for(d=q;d<n;d++)a.board.c[b][d].markers.clear(a.marker.numberBase+f.value)}}};a.paintCell=function(b){try{var e=a.canvas.getContext("2d");e.fillStyle=0==b.color&&a.level.patternx?0==b.area2%2?a.uic.shade1:a.uic.shade2:a.uic.light[b.color];e.fillRect(b.px,b.py,a.unit.x,a.unit.y);a.level.options.contains("diagonals")&&(b.x==b.y&&a.paintDiagonal(b,1),b.x==n-b.y-1&&a.paintDiagonal(b,2));a.paintSymbolMarkers(b);a.paintValueMarkers(b);if(b.label!=nil){var f=b.label.toString();if(a.variant.is(a.variant.kendoku))switch(b.clues){case 1:f+=
"+";break;case 2:f+="\u2013";break;case 3:f+="\u00d7";break;case 4:f+="/"}var d=2==b.error&&a.display.errors?a.uic.error:a.uic.text;a.paintClue(e,f,d,b.px,b.py,a.unit.x/3,a.unit.y/3,100)}b.value!=nil&&(d=b.error&&2!=b.error&&a.display.errors?a.uic.error:b.fixed?a.uic.clue:a.uic.text,a.paintValue(e,b.value.toString(),d,b.px,b.py,a.unit.x,a.unit.y,66));b.error&&a.display.errors&&b.value==nil&&a.paintErrorDot(b)}catch(h){throw a.exception(h),h;}};a.paintClue=function(b,e,f,d,h,k,c,g){try{if(void 0!==
e&&null!=e){if(void 0===f||null==f)f=a.uic.text;g||(g=66);b.textAlign="left";b.textBaseline="top";b.font=Math.floor(k*g/100).toString()+"px sans-serif";b.fillStyle=f;b.fillText(e,d+4,h+4)}}catch(r){throw a.exception(r),r;}};a.paintValue=function(b,e,f,d,h,k,c,g){try{if(void 0!==e&&null!=e){if(void 0===f||null==f)f=a.uic.text;g||(g=66);b.textAlign="right";b.textBaseline="alphabetic";b.font=Math.floor(k*g/100).toString()+"px sans-serif";b.fillStyle=f;b.fillText(e,d+k-a.unit.x/6,h+c-a.unit.y/6)}}catch(r){throw a.exception(r),
r;}}}Kendoku.prototype=new Puzzle;
