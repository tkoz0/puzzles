function Starbattle(){var a=this;a.constructor();a.uis.puzzle=["Star Battle","Sternenschlacht"];var h=a.board.c,n=a.alist,k=0,l=0,q=[-1,-1,0,1,1,1,0,-1],r=[0,-1,-1,-1,0,1,1,1];a.charToValue=a.charToValue.concat(["a",1,"s",0,"d",nil,".",1,",",0,"-",nil,"o",1,"x",0,"/",nil,"*",1]);a.keys=a.keys.concat(["stars"]);a.cell.values=[1,0,nil];a.enable.dragging=!0;a.cell.nilalias=0;a.keypad.left=nil;a.uis.stars=["Stars","Sterne","Etoiles","Stelle"];a.init=function(){Object.getPrototypeOf(a).init.call(a)};a.reset2=
function(){try{k=a.size.x;l=a.size.y;a.infoText=a.uis.get("stars")+": "+a.level.depth;a.level.areas&&a.reset2areas(0,0,k,l,a.level.areas);if(a.level.problem){var b=0;var c=a.level.problem.replace(/\s+/g," ").trim().split(" ");for(var d=0;d<l;d++)for(var f=0;f<k;f++){var e=h[f][d];var g=c[b++];"."!=g&&"-"!=g&&("x"==g?e.value=0:"o"==g&&(e.value=1));e.value!=nil&&(e.fixed=!0)}}if(a.level.solution)for(b=0,c=a.level.solution.replace(/\s+/g," ").trim().split(" "),d=0;d<l;d++)for(f=0;f<k;f++)e=h[f][d],g=
c[b++],"x"==g&&(e.solution=1)}catch(m){throw a.exception(m),m;}};a.check2=function(){var b;try{for(var c=0;c<l;c++){for(var d=b=0;d<k;d++)1==h[d][c].value&&b++;if(b!=a.size.z)for(d=0;d<k;d++)h[d][c].error=1}for(d=0;d<k;d++){for(c=b=0;c<l;c++)1==h[d][c].value&&b++;if(b!=a.size.z)for(c=0;c<l;c++)h[d][c].error=1}for(var f=1;f<n.length;f++){for(var e=b=0;e<n[f].length;e++)1==n[f][e].value&&b++;if(b!=a.size.z)for(e=0;e<n[f].length;e++)n[f][e].error=1}for(d=0;d<k;d++)for(c=0;c<l;c++)if(1==h[d][c].value)for(e=
0;8>e;e++){var g=d+q[e],m=c+r[e];0<=g&&g<k&&0<=m&&m<l&&1==h[g][m].value&&(h[g][m].error=2)}}catch(p){throw a.exception(p),p;}};a.valueToString=function(a,c){switch(a){case 1:return c?"s":"x";case 0:return c?"x":".";default:return"-"}};a.paintCell=function(b){try{var c=a.canvas.getContext("2d");c.fillStyle=b.areas==a.cell.black?a.uic.black:a.uic.light[b.color];c.fillRect(b.px,b.py,a.unit.x,a.unit.y);b.areas!=a.cell.black&&(1==b.value?a.paintStar(b):0==b.value&&a.paintCross(b,{color:a.uic.cross}),a.paintSymbolMarkers(b),
0!=b.error&&a.display.errors&&(b.value!=nil?a.paintErrorSquare(b):a.paintErrorDot(b)))}catch(d){throw a.exception(d),d;}};a.paintCurrentValue=function(){try{var b=a.uie.value,c=b.getContext("2d");c.fillStyle=a.uic.white;c.fillRect(0,0,b.width,b.height);var d={x:0,y:0,w:b.width,h:b.height};1==a.current.value?a.paintStar(c,d):0==a.current.value&&a.paintCross(c,d)}catch(f){throw a.exception(f),f;}}}Starbattle.prototype=new Puzzle;
