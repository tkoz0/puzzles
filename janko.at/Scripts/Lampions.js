function Lampions(){var a=this;a.constructor();a.uis.puzzle=["Lampions"];var h=a.board.c,l=0,m=0,n=0,p=0,q=nil,t=[0,1,1,1,0,-1,-1,-1],u=[-1,-1,0,1,1,1,0,-1];a.charToValue=a.charToValue.concat(["a",0,"s",1,"d",nil,"x",0,"c",1,"v",nil,",",0,".",1,"-",nil,"/",nil]);a.cell.values=[0,1,q];a.enable.dragging=!0;a.enable.plines=!1;a.enable.pgrid=!1;a.keypad.left=nil;a.init=function(){Object.getPrototypeOf(a).init.call(a)};a.reset2=function(){try{l=a.labels.west;m=a.labels.north;n=a.size.x-a.labels.east;p=
a.size.y-a.labels.south;if(a.level.problem){var b=0;var c=a.level.problem.replace(/\s+/g," ").trim().split(" ");for(var e=m;e<p;e++)for(var d=l;d<n;d++){var g=h[d][e];var f=c[b++];g.label="x"==f||"-"==f?nil:parseInt(f)}}if(a.level.solution)for(b=0,c=a.level.solution.replace(/\s+/g," ").trim().split(" "),e=m;e<p;e++)for(d=l;d<n;d++)g=h[d][e],f=c[b++],g.solution="x"==f?1:0}catch(r){throw a.exception(r),r;}};a.check2=function(){try{for(var b=0,c=l;c<n;c++)for(var e=m;e<p;e++){var d=h[c][e];if(d.label!=
nil){var g=a.countAdjacentLightCells(c,e);d.value==nil&&(d.error=1);1==d.value&&d.label!=g&&(d.error=2);0==d.value&&d.label==g&&(d.error=2);1==d.value&&b++}}0==b&&(a.solved=!1)}catch(f){throw a.exception(f),f;}};a.countAdjacentLightCells=function(b,c){try{var e=1==h[b][c].value?1:0;for(k=0;8>k;k++){var d=b+t[k],g=c+u[k];d>=l&&d<n&&g>=m&&g<p&&1==h[d][g].value&&e++}return e}catch(f){throw a.exception(f),f;}};a.valueToString=function(a,c){switch(a){case nil:return"-";case 1:return"x";case 0:return c?
".":"-";default:return"%"}};a.paintCell=function(b){try{var c=a.canvas.getContext("2d");c.fillStyle=b.value==nil?a.paintToImage&&a.moves.current==nil?a.uic.white:a.uic.gray:1==b.value?a.uic.light[b.color]:b.error&&a.display.errors?a.uic.error:a.uic.dark[b.color];c.strokeStyle=b.error&&a.display.errors?a.uic.error:a.uic.black;c.lineWidth=1;c.beginPath();c.arc(b.px+a.unit.x/2,b.py+a.unit.y/2,a.unit.x/2-a.unit.x/10,0,2*Math.PI);c.fill();c.stroke();b.label!=nil&&a.paintText(b.label.toString(),b,{color:0!=
b.value?a.uic.text:a.uic.text2});a.paintSymbolMarkers(b);b.error&&a.display.errors&&a.paintErrorCircle(b)}catch(e){throw a.exception(e),e;}};a.paintCurrentValue=function(){try{var b=a.uie.value,c=b.getContext("2d");c.fillStyle=a.current.value==q?a.uic.gray:0==a.current.value?a.uic.black:a.uic.white;c.fillRect(0,0,b.width,b.height)}catch(e){throw a.exception(e),e;}}}Lampions.prototype=new Puzzle;
