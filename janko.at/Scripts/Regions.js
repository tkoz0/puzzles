function Regions(){var a=this;a.constructor();a.uis.puzzle=["Regions","Regionen"];var f=a.board.c,C=a.board.l,u=a.board.h,v=a.board.v,h=a.alist,y=0,z=0,p=0,m=0;a.variant.generic=["generic",["Regions","Gebiete"]];a.variant.araf=["araf",["Araf"]];a.variant.boda=["boda",["Bodaburokku"]];a.variant.burokku=["burokku",["Burokku"]];a.variant.foseruzu=["foseruzu",["Foseruzu/Faibuseruzu"]];a.variant.galaxies=["galaxies",["Galaxies","Galaxien"]];a.variant.knossos=["knossos",["Knossos"]];a.variant.neighbours=
["neighbours",["Naighbours","Nachbarn"]];a.variant.renkatsu=["renkatsu",["Rankatsu"]];a.variant.tetroid=["tetroid",["Tatroid"]];a.variant.yonmasu=["yonmasu",["Yonmasu"]];var x={any:nil-1,cross:nil-2,black:nil-3,circle:nil-4,L:76,I:73,T:84,S:83,O:79};a.line.values=[a.line.wall,a.line.cross,a.line.grid];a.keypadValues=a.keypad.colors.slice(0,10);a.enable.dragging=!0;a.enable.cells=!0;a.enable.lines=!a.config.touch;a.keypad.left=nil;a.keypad.right=a.keypad.pgvalues;a.cell.min=0;a.cell.max=9;a.uic.area=
"#cccccc";a.uic.temp="#ffdddd";a.uic.count="#99cc99";a.uic.dotfill="#999999";a.uic.dotedge="#000000";a.init=function(){Object.getPrototypeOf(a).init.call(a)};a.setup2=function(){try{a.labels.north=a.labels.south=a.labels.east=a.labels.west=0;if(a.level.nlabels){var b=a.level.nlabels.replace(/\s+/g," ").trim().split(" ");a.labels.west=parseInt(b[0]);a.labels.north=parseInt(b[1]);a.labels.east=parseInt(b[2]);a.labels.south=parseInt(b[3])}a.level.image&&(a.enable.pgrid=a.enable.pframe=!1)}catch(c){throw a.exception(c),
c;}};a.reset2=function(){try{!a.level.puzzle&&a.level.variant&&(a.level.puzzle=a.level.variant);a.variant.init(a.variant.burokku);y=a.labels.west;z=a.labels.north;p=a.size.x-a.labels.east;m=a.size.y-a.labels.south;zmax=a.size.z;a.variant.is(a.variant.neighbours)||a.variant.is(a.variant.burokku)||a.variant.is(a.variant.foseruzu)?a.infoText=a.uis.get("size")+": "+a.size.z:a.infoText="";if(a.level.problem){var b=0;var c=a.level.problem.replace(/\s+/g," ").trim().split(" ");for(var d=z;d<m;d++)for(var e=
y;e<p;e++){var g=f[e][d];var l=c[b++];"-"!=l&&"."!=l&&("@"==l?(g.value=nil,g.areas=a.cell.outside,g.label=x.black,g.fixed=!0,g.valid=!1):"#"==l||"x"==l?(g.value=nil,g.areas=a.cell.black,g.label=x.black,g.fixed=!0):g.label="o"==l?x.circle:"?"==l?x.any:"a"<=l&&"z">=l?l.charCodeAt(0)-96:"A"<=l&&"Z">=l?l.charCodeAt(0)-64:parseInt(l))}}if(a.level.solution){b=0;c=a.level.solution.replace(/\s+/g," ").trim().split(" ");for(d=z;d<m;d++)for(e=y;e<p;e++)g=f[e][d],l=c[b++],g.count="."==l||"-"==l||"#"==l||"@"==
l?nil:parseInt(l);var r=1;for(e=y;e<p;e++)for(d=z;d<m;d++)if(f[e][d].count!=nil){for(var q=f[e][d].count,n=y;n<p;n++)for(var h=z;h<m;h++)g=f[n][h],g.count==q&&(g.solution=r,g.count=nil);r++}for(e=1;e<p;e++)for(d=z;d<m;d++)v[e][d].solution=f[e][d].solution!=f[e-1][d].solution?a.line.wall:a.line.grid;for(d=1;d<m;d++)for(e=y;e<p;e++)u[e][d].solution=f[e][d].solution!=f[e][d-1].solution?a.line.wall:a.line.grid}a.level.lines&&a.reset2lines(y,z,p,m,a.level.lines);for(e=y;e<p;e++)for(d=z;d<m;d++)f[e][d].label==
x.black&&(0<e&&f[e-1][d].label!=x.black&&(v[e][d].value=v[e][d].solution=a.line.wall),e<p-1&&f[e+1][d].label!=x.black&&(v[e+1][d].value=v[e+1][d].solution=a.line.wall),0<d&&f[e][d-1].label!=x.black&&(u[e][d].value=u[e][d].solution=a.line.wall),d<m-1&&f[e][d+1].label!=x.black&&(u[e][d+1].value=u[e][d+1].solution=a.line.wall));if(a.variant.is(a.variant.burokku)){for(e=y;e<p-1;e++)for(d=z;d<m;d++)f[e][d].label==f[e+1][d].label&&f[e][d].label!=nil?v[e+1][d].value=a.line.wall:a.level.options.contains("sum")&&
f[e][d].label+f[e+1][d].label==p&&(v[e+1][d].value=a.line.cross);for(e=y;e<p;e++)for(d=z;d<m-1;d++)f[e][d].label==f[e][d+1].label&&f[e][d].label!=nil?u[e][d+1].value=a.line.wall:a.level.options.contains("sum")&&f[e][d].label+f[e][d+1].label==m&&(u[e][d+1].value=a.line.cross)}for(b=0;b<C.length;b++)C[b].value!=nil&&(C[b].fixed=!0);for(e=y;e<p;e++)r=u,r[e][0].valid=r[e][m].valid=!1,r[e][0].value=r[e][0].solution=r[e][m].value=r[e][m].solution=a.line.wall;for(d=z;d<m;d++)l=v,l[0][d].valid=l[p][d].valid=
!1,l[0][d].value=l[0][d].solution=l[p][d].value=l[p][d].solution=a.line.wall;if(a.level.celltext)for(b=0,c=a.level.celltext.replace(/\s+/g," ").replace(/&gt;/gi,">").replace(/&lt;/gi,"<").trim().split(" "),d=0;d<a.size.y;d++)for(e=0;e<a.size.x;e++)g=f[e][d],l=c[b++],g.text="."==l||"-"==l?"":l}catch(B){throw a.exception(B),B;}};a.check2=function(){try{for(var b=1,c=y;c<p;c++)for(var d=z;d<m;d++)0==f[c][d].count&&f[c][d].label!=x.black&&a.markArea(c,d,b++);a.alist.length=0;for(c=y;c<p;c++)for(d=z;d<
m;d++){var e=f[c][d],g=1>e.count?0:e.count;a.alist[g]||(a.alist[g]=[]);a.alist[g][a.alist[g].length]=e}for(c=y;c<p;c++)for(d=1;d<m;d++)u[c][d].value==a.line.wall&&f[c][d-1].count==f[c][d].count&&(u[c][d].error=6);for(c=1;c<p;c++)for(d=z;d<m;d++)v[c][d].value==a.line.wall&&f[c-1][d].count==f[c][d].count&&(v[c][d].error=6);a.variant.is(a.variant.araf)&&a.check2Araf();a.variant.is(a.variant.burokku)&&a.check2Burokku(b);a.variant.is(a.variant.renkatsu)&&a.check2Renkatsu(b);a.variant.is(a.variant.foseruzu)&&
a.check2Foseruzu(b);a.variant.is(a.variant.galaxies)&&a.check2Galaxies(b);a.variant.is(a.variant.tetroid)&&a.check2Tetroid();a.variant.is(a.variant.yonmasu)&&a.check2Yonmasu();(a.variant.is(a.variant.knossos)||a.variant.is(a.variant.tetroid)||a.variant.is(a.variant.foseruzu)||a.variant.is(a.variant.neighbours))&&a.check2Areas(b);for(b=0;b<h.length;b++)if(h[b]){c=!1;for(k=0;k<h[b].length;k++)h[b][k].marked=!1,h[b][k].error&&(c=!0);if(!c)for(k=0;k<h[b].length;k++)h[b][k].error||(h[b][k].color=0,h[b][k].value=
b+10,h[b][k].marked=!0)}}catch(l){throw a.exception(l),l;}};a.check2Araf=function(b){try{for(b=1;b<h.length;b++){for(var c=null,d=null,e=0;e<h[b].length;e++)h[b][e].label!=nil&&(null==c?c=h[b][e]:null==d?d=h[b][e]:c.error=d.error=h[b][e].error=9);if(null==c)for(e=0;e<h[b].length;e++)h[b][e].error=9;else if(null==d)c.error=9;else if(h[b].length<=Math.min(c.label,d.label)||h[b].length>=Math.max(c.label,d.label))for(e=0;e<h[b].length;e++)0==h[b][e].error&&(h[b][e].error=4)}}catch(g){throw a.exception(g),
g;}};a.check2Burokku=function(b){try{for(b=1;b<h.length;b++)if(h[b].length!=a.size.z)for(var c=0;c<h[b].length;c++)h[b][c].error=1;for(b=1;b<h.length;b++){var d=[];for(c=0;1E3>c;c++)d[c]=null;for(c=0;c<h[b].length;c++){var e=h[b][c];e.label!=nil&&(null==d[e.label]?d[e.label]=e:e.error=d[e.label].error=8)}}}catch(g){throw a.exception(g),g;}};a.check2Renkatsu=function(b){try{for(b=1;b<h.length;b++){for(var c=[],d=0;1E3>d;d++)c[d]=null;for(d=0;d<h[b].length;d++){var e=h[b][d];e.label!=nil&&(null==c[e.label]?
c[e.label]=e:e.error=c[e.label].error=8)}for(d=1;d<=h[b].length;d++)if(!c[d])for(var f=0;f<h[b].length;f++)h[b][f].error=11}}catch(l){throw a.exception(l),l;}};a.check2Foseruzu=function(){try{for(var b=y;b<p;b++)for(var c=z;c<m;c++)if(f[b][c].label!=nil){var d=0;u[b][c].value==a.line.wall&&d++;u[b][c+1].value==a.line.wall&&d++;v[b][c].value==a.line.wall&&d++;v[b+1][c].value==a.line.wall&&d++;d!=f[b][c].label&&(f[b][c].error=1)}}catch(e){throw a.exception(e),e;}};a.check2Galaxies=function(b){var c;
try{for(c=1;c<=b;c++){for(var d=0,e=y;e<p;e++)for(var g=z;g<m;g++)f[e][g].count==c&&f[e][g].label!=nil&&d++;if(1!=d)for(e=y;e<p;e++)for(g=z;g<m;g++)f[e][g].count==c&&(f[e][g].count=0)}for(e=y;e<p;e++)for(g=z;g<m;g++)if(f[e][g].label!=nil&&0!=f[e][g].count)for(b=0;b<p;b++)for(d=0;d<m;d++)if(f[b][d].count==f[e][g].count){f[b][d].marked=!0;var l=nil,r=nil;switch(f[e][g].label){case 0:l=e+(e-b);r=g+(g-d);break;case 1:l=e+(e-b)+1;r=g+(g-d);break;case 2:l=e+(e-b);r=g+(g-d)+1;break;case 3:l=e+(e-b)+1,r=
g+(g-d)+1}if(0<=l&&l<p&&0<=r&&r<m&&f[e][g].count==f[l][r].count)f[l][r].marked=!0;else for(c=f[e][g].count,l=0;l<p;l++)for(r=0;r<m;r++)f[l][r].count==c&&(f[l][r].count=0)}for(e=y;e<p;e++)for(g=z;g<m;g++)0!=f[e][g].count&&f[e][g].marked||(f[e][g].error=7)}catch(q){throw a.exception(q),q;}};a.check2Tetroid=function(b){try{for(b=y;b<p;b++)for(var c=z;c<m;c++){var d=f[b][c];if(!d.checked&&d.areas!=a.cell.outside&&d.areas!=a.cell.black){for(var e=p,g=0,l=m,r=0,q=0;q<p;q++)for(var n=0;n<m;n++)f[q][n].count==
d.count&&(q<e&&(e=q),q>g&&(g=q),n<l&&(l=n),n>r&&(r=n));var h=nil;e==g&&3==r-l||l==r&&3==g-e?h=x.I:1==g-e&&1==r-l?h=x.O:(2==g-e&&1==r-l||1==g-e&&2==r-l)&&(f[e][l].count!=d.count&&f[g][r].count!=d.count||f[g][l].count!=d.count&&f[e][r].count!=d.count)?h=x.S:(2==g-e&&1==r-l||1==g-e&&2==r-l)&&(f[e][l].count!=d.count&&f[e][r].count!=d.count||f[g][l].count!=d.count&&f[g][r].count!=d.count||f[e][l].count!=d.count&&f[g][l].count!=d.count||f[e][r].count!=d.count&&f[g][r].count!=d.count)?h=x.T:1==g-e&&2==r-
l&&(f[e][l].count==d.count&&f[e][l+1].count==d.count||f[g][l].count==d.count&&f[g][l+1].count==d.count||f[e][r].count==d.count&&f[e][r-1].count==d.count||f[g][r].count==d.count&&f[g][r-1].count==d.count)?h=x.L:2==g-e&&1==r-l&&(f[e][l].count==d.count&&f[e+1][l].count==d.count||f[e][r].count==d.count&&f[e+1][r].count==d.count||f[g][l].count==d.count&&f[g-1][l].count==d.count||f[g][r].count==d.count&&f[g-1][r].count==d.count)?h=x.L:a.solved=!1;for(q=e;q<=g;q++)for(n=l;n<=r;n++)f[q][n].count==d.count&&
(f[q][n].label=h,f[q][n].checked=!0)}}for(b=y;b<p;b++)for(c=z;c<m;c++)b<p-1&&f[b][c].count!=f[b+1][c].count&&f[b][c].label==f[b+1][c].label&&(f[b][c].error=f[b+1][c].error=12),c<m-1&&f[b][c].count!=f[b][c+1].count&&f[b][c].label==f[b][c+1].label&&(f[b][c].error=f[b][c+1].error=12)}catch(B){throw a.exception(B),B;}};a.check2Yonmasu=function(b){try{for(b=1;b<h.length;b++){if(4!=h[b].length)for(var c=0;c<h[b].length;c++)h[b][c].error=1;var d=null;for(c=0;c<h[b].length;c++)h[b][c].label==x.circle&&(null==
d?d=h[b][c]:d.error=h[b][c].error=9);if(null==d)for(c=0;c<h[b].length;c++)h[b][c].error=9}}catch(e){throw a.exception(e),e;}};a.check2Areas=function(b){try{for(var c=1;c<b;c++){for(var d=0,e=0,g=0,l=nil,r=nil,q=y;q<p;q++)for(var n=z;n<m;n++)f[q][n].count==c&&(d++,f[q][n].label!=nil&&f[q][n].label!=x.black&&(g++,l=q,r=n),(q==y||q>y&&f[q-1][n].count!=c)&&e++,(n==z||n>z&&f[q][n-1].count!=c)&&e++,(q==p-1||q<p-1&&f[q+1][n].count!=c)&&e++,(n==m-1||n<m-1&&f[q][n+1].count!=c)&&e++);if(!a.variant.is(a.variant.foseruzu)&&
!a.variant.is(a.variant.tetroid)&&1!=g||a.variant.is(a.variant.neighbours)&&d!=a.size.z||a.variant.is(a.variant.foseruzu)&&d!=a.size.z||a.variant.is(a.variant.tetroid)&&4!=d&&1!=d||a.variant.is(a.variant.knossos)&&e!=f[l][r].label)for(q=y;q<p;q++)for(n=z;n<m;n++)f[q][n].count==c&&(f[q][n].error=1);if(a.variant.is(a.variant.neighbours)&&1==g&&f[l][r].label!=x.any){d=[];for(q=y;q<p;q++)for(n=z;n<m;n++)f[q][n].count==c&&(0<q&&0!=f[q-1][n].count&&(d[f[q-1][n].count]=!0),q<p-1&&0!=f[q+1][n].count&&(d[f[q+
1][n].count]=!0),0<n&&0!=f[q][n-1].count&&(d[f[q][n-1].count]=!0),n<m-1&&0!=f[q][n+1].count&&(d[f[q][n+1].count]=!0));e=-1;for(g=0;g<=b;g++)d[g]&&e++;if(l==nil||r==nil||e!=f[l][r].label)for(q=y;q<p;q++)for(n=z;n<m;n++)f[q][n].count==c&&(f[q][n].error=1)}}}catch(D){throw a.exception(D),D;}};a.markArea=function(b,c,d){try{f[b][c].count=d,0!=b&&0==f[b-1][c].count&&v[b][c].value!=a.line.wall&&a.markArea(b-1,c,d),b!=p-1&&0==f[b+1][c].count&&v[b+1][c].value!=a.line.wall&&a.markArea(b+1,c,d),0!=c&&0==f[b][c-
1].count&&u[b][c].value!=a.line.wall&&a.markArea(b,c-1,d),c!=m-1&&0==f[b][c+1].count&&u[b][c+1].value!=a.line.wall&&a.markArea(b,c+1,d)}catch(e){throw a.exception(e),e;}};a.cleanSolution=function(){for(var b=y;b<p;b++)for(var c=z;c<m;c++)f[b][c].value=0==f[b][c].count?nil:f[b][c].count;for(b=1;b<p;b++)for(c=z;c<m;c++)v[b][c].value=f[b][c].value!=f[b-1][c].value?a.line.wall:a.line.grid;for(c=1;c<m;c++)for(b=y;b<p;b++)u[b][c].value=f[b][c].value!=f[b][c-1].value?a.line.wall:a.line.grid};a.solve2=function(){try{a.variant.is(a.variant.foseruzu)&&
a.solve2Foseruzu(),a.variant.is(a.variant.burokku)&&a.solve2Burokku()}catch(b){throw a.exception(b),b;}};a.solve2Foseruzu=function(){try{for(var b=y;b<p;b++)for(var c=z;c<m;c++)0==f[b][c].label?u[b][c].value=v[b][c].value=u[b][c+1].value=v[b+1][c].value=a.line.cross:1==f[b][c].label?0==b?v[b+1][c].value=u[b][c+1].value=u[b][c].value=a.line.cross:b==p-1?v[b][c].value=u[b][c+1].value=u[b][c].value=a.line.cross:0==c?u[b][c+1].value=v[b+1][c].value=v[b][c].value=a.line.cross:c==m-1&&(u[b][c].value=v[b+
1][c].value=v[b][c].value=a.line.cross):2==f[b][c].label&&(0==b&&0==c?v[b+1][c].value=u[b][c+1].value=a.line.cross:0==b&&c==m-1?v[b+1][c].value=u[b][c].value=a.line.cross:b==p-1&&0==c?v[b][c].value=u[b][c+1].value=a.line.cross:b==p-1&&c==m-1&&(v[b][c].value=u[b][c].value=a.line.cross))}catch(d){throw a.exception(d),d;}};a.solve2Burokku=function(){try{var b=function(c,h){var n=a.board.c[c][h];n.value=r;e[n.label]=!0;l[g]=10*c+h;g++;var p=null;1<c&&n.label+f[c-1][h].label==a.size.z-2?p=f[c-1][h]:c<
a.size.x-1&&n.label+f[c+1][h].label==a.size.z-2?p=f[c+1][h]:1<h&&n.label+f[c][h-1].label==a.size.z-2?p=f[c][h-1]:h<a.size.y-1&&n.label+f[c][h+1].label==a.size.z-2&&(p=f[c][h+1]);null!=p&&n.value==p.value&&(p=null);n=!1;null!=p&&(g==a.size.z||e[p.label]?n=!0:(p.value=r,e[p.label]=!0,l[g]=10*p.x+p.y,g++));if(!n)if(g<a.size.z)for(var m=0;m<g;m++){var w=Math.floor(l[m]/10),u=l[m]%10;if(0<w){var A=f[w-1][u];A.value!=nil||e[A.label]||b(w-1,u)}w<a.size.x-1&&(A=f[w+1][u],A.value!=nil||e[A.label]||b(w+1,u));
0<u&&(A=f[w][u-1],A.value!=nil||e[A.label]||b(w,u-1));u<a.size.y-1&&(A=f[w][u+1],A.value!=nil||e[A.label]||b(w,u+1))}else{Array.sort(t);A="";for(m=0;m<a.size.z;m++)A+=intToStr(t[m])+" ";if(!q.containsKey(A)&&(q[A]="Dummy",r==a.size.z-1)){d++;println("Solution "+d);for(m=0;m<a.size.y;m++){A="";for(w=0;w<a.size.x;w++)A+=f[w][m].value+" ";println(A)}println();for(w=0;w<a.size.x;w++)for(m=0;m<a.size.y;m++)f[w][m].solution=f[w][m].color=f[w][m].value+1;m=1;for(A=y;A<a.size.x;A++)for(w=z;w<selfs.size.y;w++)if(f[A][w].work!=
nil){u=f[A][w].work;for(var v=0;v<a.size.x;v++)for(var x=0;x<a.size.y;x++)f[v][x].work==u&&(f[v][x].solution=m,f[v][x].work=nil);m++}for(A=1;A<a.size.x;A++)for(w=z;w<a.size.y;w++)f[A][w].solution!=f[A-1][w].solution&&(a.board.v[A][w].value=a.board.v[A][w].solution=a.lines.wall);for(w=1;w<a.size.y;w++)for(A=y;A<a.size.x;A++)f[A][w].solution!=f[A][w-1].solution&&(a.board.h[A][w].value=a.board.h[A][w].solution=a.lines.wall)}}null==p||n||(p.value=nil,e[p.label]=!1,g--);f[c][h].value=nil;e[f[c][h].label]=
!1;g--},c=function(){q={};var d=y;a:for(;d<a.size.x;d++)for(var l=z;l<a.size.y;l++)if(f[d][l].value==nil){for(var h=g=0;h<a.size.z;h++)e[h]=!1;b(d,l);break a}for(var m in q)if(q.hasOwnProperty(m)){d=q[m].split(" ");for(h=0;h<a.size.z;h++)f[Math.floor(d[h]/10)][d[h]%10].value=r;r++;c();r--;for(h=0;h<a.size.z;h++)f[Math.floor(d[h]/10)][d[h]%10].value=nil}},d=0,e=[],g,l=[],r=0,q={};a.paintMessage(a.uis.get("solving"));r=0;for(var n=y;n<p;n++)for(var h=z;h<m;h++)f[n][h].value=nil;c();switch(d){case 0:a.paintMessage(a.uis.get("nosol"));
break;case 1:a.paintMessage(a.uis.get("onesol"));break;default:a.paintMessage(a.uis.get("manysol"))}a.paint()}catch(B){throw a.exception(B),B;}};a.dragTo2=function(b,c){try{a.makeMove(b,c.value,c.color)}catch(d){throw a.exception(d),d;}};a.makeMove=function(b,c,d,e){try{var f=a.checking.disable;a.checking.disable=0;Object.getPrototypeOf(this).makeMove.call(this,b,c,d,e);a.checking.disable=f}catch(l){throw a.exception(l),l;}};a.makeMove2=function(b,c,d){try{if(b||(b=a.current.item),b){if(b.type==a.item.cell){if(null==
c||void 0===c)c=a.current.color;0==c?c=nil:d=c;c==nil&&0!=d&&(c=d)}var e=a.checking.disable;a.checking.disable=0;Object.getPrototypeOf(this).makeMove2.call(this,b,c,d);a.checking.disable=e;if(b.type==a.item.cell&&b.value!=nil){var g=b.x,l=b.y;if(0<g&&f[g-1][l].value!=nil){var h=v[g][l];h.fixed||(f[g-1][l].value==c?h.value=a.line.grid:h.value!=a.line.wall&&(h.value=a.line.wall,h.color=0))}g<p-1&&f[g+1][l].value!=nil&&(h=v[g+1][l],h.fixed||(f[g+1][l].value==c?h.value=a.line.grid:h.value!=a.line.wall&&
(h.value=a.line.wall,h.color=0)));0<l&&f[g][l-1].value!=nil&&(h=u[g][l],h.fixed||(f[g][l-1].value==c?h.value=a.line.grid:h.value!=a.line.wall&&(h.value=a.line.wall,h.color=0)));l<m-1&&f[g][l+1].value!=nil&&(h=u[g][l+1],h.fixed||(f[g][l+1].value==c?h.value=a.line.grid:h.value!=a.line.wall&&(h.value=a.line.wall,h.color=0)))}}}catch(q){throw a.exception(q),q;}};a.showSolution2=function(){try{for(var b=y;b<p;b++)for(var c=z;c<m;c++)f[b][c].value=nil;for(b=0;b<C.length;b++)C[b].value=C[b].solution}catch(d){throw a.exception(d),
d;}};a.showHint2=function(b){try{if(b.type!=a.item.cell)Object.getPrototypeOf(this).showHint2.call(this,b);else{for(var c=y;c<p;c++)for(var d=z;d<m;d++)f[c][d].solution==b.solution&&(f[c][d].value=nil,u[c][d].value=u[c][d].solution,u[c][d+1].value=u[c][d+1].solution,v[c][d].value=v[c][d].solution,v[c+1][d].value=v[c+1][d].solution,f[c][d].color=0,u[c][d].color=u[c][d+1].color=v[c][d].color=v[c+1][d].color=a.current.color);a.pushMove(b,a.moves.typeHint)}}catch(e){throw a.exception(e),e;}};a.labelToString=
function(b,c){try{return b==x.nil?"-":b==x.any?"?":b==x.black?"#":b==x.cross?"x":b==x.circle?"o":a.numberToString(b)}catch(d){return ojdebug(d.toString()),"%"}};a.onValues=function(){try{a.config.touch&&(a.enable.lines?(a.enable.lines=!1,a.enable.cells=!0):(a.enable.lines=!0,a.enable.cells=!1))}catch(b){throw a.exception(b),b;}};a.paintCell=function(b){try{var c=a.canvas.getContext("2d");a.level.image||(c.fillStyle=b.label==x.black?a.uic.black:a.paintToImage&&a.solved?a.uic.light[b.value%9+1]:b.marked?
a.uic.area:b.value==nil?a.uic.light[0]:a.uic.light[b.color],c.fillRect(b.px,b.py,a.unit.x,a.unit.y));if(!a.variant.is(a.variant.galaxies))if(b.label==x.any)a.paintText("?",b);else if(b.label==x.circle)a.paintCircle(b);else if(b.label>nil)if(a.variant.is(a.variant.burokku))a.paintText(String.fromCharCode(b.label+64),b);else if(a.variant.is(a.variant.tetroid))switch(b.label){case x.L:a.paintText("L",b);break;case x.I:a.paintText("I",b);break;case x.T:a.paintText("T",b);break;case x.S:a.paintText("S",
b);break;case x.O:a.paintText("O",b)}else a.paintText(b.label.toString(),b);b.text&&a.paintCellText(b);a.paintSymbolMarkers(b);b.error&&a.display.errors&&(b.label==nil?a.paintErrorDot(b):a.paintErrorCircle(b))}catch(d){throw a.exception(d),d;}};a.paintCellText=function(b){try{a.canvas.getContext("2d");var c={scale:50,fill:a.uic.markfill,stroke:a.uic.markedge},d={scale:50,fill:a.uic.none,stroke:a.uic.markedge},e=b.text;e.contains("$c;")&&(e=e.replace("$c;",""),a.paintCircle(b,c));e.contains("$C;")&&
(e=e.replace("$C;",""),a.paintCircle(b,d));e.contains("$q;")&&(e=e.replace("$q;",""),a.paintSquare(b,c));e.contains("$Q;")&&(e=e.replace("$Q;",""),a.paintSquare(b,d));e.contains("$n;")&&(e=e.replace("$n;",""),d.v=0,a.paintArrow(b,d));e.contains("$N;")&&(e=e.replace("$N;",""),c.v=0,a.paintArrow(b,c));e.contains("$s;")&&(e=e.replace("$s;",""),d.v=1,a.paintArrow(b,d));e.contains("$S;")&&(e=e.replace("$S;",""),c.v=1,a.paintArrow(b,c));e.contains("$e;")&&(e=e.replace("$e;",""),d.v=2,a.paintArrow(b,d));
e.contains("$E;")&&(e=e.replace("$E;",""),c.v=2,a.paintArrow(b,c));e.contains("$w;")&&(e=e.replace("$w;",""),d.v=3,a.paintArrow(b,d));e.contains("$W;")&&(e=e.replace("$W;",""),c.v=3,a.paintArrow(b,c));e.contains("$nw;")&&(e=e.replace("$nw;",""),d.v=4,a.paintArrow(b,d));e.contains("$NW;")&&(e=e.replace("$NW;",""),c.v=4,a.paintArrow(b,c));e.contains("$sw;")&&(e=e.replace("$sw;",""),d.v=5,a.paintArrow(b,d));e.contains("$SW;")&&(e=e.replace("$SW;",""),c.v=5,a.paintArrow(b,c));e.contains("$ne;")&&(e=e.replace("$ne;",
""),d.v=7,a.paintArrow(b,d));e.contains("$NE;")&&(e=e.replace("$NE;",""),c.v=7,a.paintArrow(b,c));e.contains("$se;")&&(e=e.replace("$se;",""),d.v=6,a.paintArrow(b,d));e.contains("$SE;")&&(e=e.replace("$SE;",""),c.v=6,a.paintArrow(b,c));e&&a.paintText(b.text,b)}catch(g){throw a.exception(g),g;}};a.paintDone=function(){try{if(a.variant.is(a.variant.galaxies)){var b=a.canvas.getContext("2d");b.fillStyle=a.uic.dotfill;b.strokeStyle=a.uic.dotedge;b.lineWidth=1;for(var c=a.unit.x/8,d=y;d<p;d++)for(var e=
z;e<m;e++){var g=f[d][e];0==g.label&&(b.beginPath(),b.arc(g.px+a.unit.x/2,g.py+a.unit.y/2,c,0,2*Math.PI),b.fill(),b.stroke());3==g.label&&(b.beginPath(),b.arc(g.px+a.unit.x,g.py+a.unit.y,c,0,2*Math.PI),b.fill(),b.stroke());1==g.label&&(b.beginPath(),b.arc(g.px+a.unit.x,g.py+a.unit.y/2,c,0,2*Math.PI),b.fill(),b.stroke());2==g.label&&(b.beginPath(),b.arc(g.px+a.unit.x/2,g.py+a.unit.y,c,0,2*Math.PI),b.fill(),b.stroke())}}}catch(l){throw a.exception(l),l;}};a.paintCurrentValue=function(){try{var b=a.uie.value,
c=b.getContext("2d"),d={x:0,y:0,w:b.width,h:b.height,scale:90};c.fillStyle=a.uic.white;c.fillRect(0,0,b.width,b.height);a.enable.lines&&!a.enable.cells?a.paintText("#",c,d):a.current.value!=nil&&(c.fillStyle=a.uic.light[a.current.value],c.fillRect(0,0,b.width,b.height),a.paintText(a.current.value.toString(),c,d))}catch(e){throw a.exception(e),e;}}}Regions.prototype=new Puzzle;
