function Toichika(){var a=this;a.constructor();a.uis.puzzle=["Toichika"];var m=a.board.c,n=0,p=0;a.charToValue=a.charToValue.concat(["n",8,"s",2,"e",1,"w",4,".",16,"o",16,",",0,"x",0,"-",nil,"/",nil]);a.cell.values=[8,1,2,4,16,0,nil];a.enable.values=!1;a.enable.currentValue=!1;a.cell.nilalias=0;a.uic.arrowfill="#000000";a.uic.arrowedge="#000000";a.uic.arrowfillfixed="#2222ff";a.uic.arrowedgefixed="#2222ff";a.init=function(){Object.getPrototypeOf(a).init.call(a)};a.reset2=function(){try{n=a.size.x;
p=a.size.y;a.keypadValues=[[null,null],[a.paintArrowN,8],[null,null],["\u2022",nil],[a.paintArrowW,4],[a.paintCircle,16],[a.paintArrowE,1],[null,null],[null,null],[a.paintArrowS,2],[null,null],[a.paintCross,0]];a.level.areas&&a.reset2areas(0,0,n,p,a.level.areas);if(a.level.problem){var c=0;var b=a.level.problem.replace(/\s+/g," ").trim().split(" ");for(var d=0;d<p;d++)for(var g=0;g<n;g++){var e=m[g][d];var f=b[c++];"."==f||"-"==f?e.value=nil:"n"==f?e.value=8:"s"==f?e.value=2:"e"==f?e.value=1:"w"==
f?e.value=4:"x"==f&&(e.value=0);e.value!=nil&&(e.fixed=!0);e.areas<=nil&&(e.value=cross)}}if(a.level.solution)for(c=0,b=a.level.solution.replace(/\s+/g," ").trim().split(" "),d=0;d<p;d++)for(g=0;g<n;g++)e=m[g][d],f=b[c++],"."==f||"-"==f?e.solution=nil:"n"==f?e.solution=8:"s"==f?e.solution=2:"e"==f?e.solution=1:"w"==f&&(e.solution=4)}catch(h){throw a.exception(h),h;}};a.check2=function(){var c,b;try{for(var d=0;d<a.size.x;d++)for(var g=0;g<a.size.y;g++)if(!m[d][g].checked){var e=0;var f=m[d][g].areas;
for(b=0;b<n;b++)for(c=0;c<p;c++){var h=m[b][c];h.areas==f&&(h.checked=!0,8!=h.value&&1!=h.value&&2!=h.value&&4!=h.value||e++)}if(1!=e)for(b=0;b<n;b++)for(c=0;c<p;c++)m[b][c].areas==f&&(m[b][c].error=2)}for(d=0;d<n;d++)for(g=0;g<p;g++){var k=m[d][g];16==k.value&&(k.error=1);var q=h=0;8==k.value?q=-1:2==k.value?q=1:1==k.value?h=1:4==k.value&&(h=-1);if(0!=h||0!=q){f=[];b=d;for(c=g;0<=b&&b<n&&0<=c&&c<p;){var l=m[b][c];f[l.areas]=!0;if(8==k.value&&2==l.value||2==k.value&&8==l.value||1==k.value&&4==l.value||
4==k.value&&1==l.value)break;else k!=l&&l.value!=nil&&0!=l.value&&(l.error=4);b+=h;c+=q}if(0>b||b==n||0>c||c==p)k.error=5;for(h=e=0;h<f.length;h++)f[h]&&e++;3>e&&(k.error=l.error=3)}}}catch(r){throw a.exception(r),r;}};a.valueToString=function(a,b){switch(a){case 16:return"O";case 8:return"n";case 2:return"s";case 1:return"e";case 4:return"w";case 0:return b?"x":"-";default:return"-"}};a.paintCell=function(c){try{var b=a.canvas.getContext("2d");b.fillStyle=a.uic.light[c.color];b.fillRect(c.px,c.py,
a.unit.x,a.unit.y);var d={arrow:c.value,color:a.uic.black,fill:c.fixed?a.uic.arrowfillfixed:a.uic.arrowfill,stroke:c.fixed?a.uic.arrowedgefixed:a.uic.arrowedge,scale:60};switch(c.value){case 0:a.paintCross(c,d);break;case 8:case 2:case 1:case 4:a.paintArrow(c,d);break;case 16:d.fill=a.uic.white,a.paintCircle(c,d)}a.paintSymbolMarkers(c);0!=c.error&&a.display.errors&&(c.value==nil?a.paintErrorDot(c):a.paintErrorCircle(c))}catch(g){throw a.exception(g),g;}};a.paintArrowN=function(c,b){b.arrow=8;b.fill=
b.stroke=a.uic.black;a.paintArrow(c,b)};a.paintArrowS=function(c,b){b.arrow=2;b.fill=b.stroke=a.uic.black;a.paintArrow(c,b)};a.paintArrowE=function(c,b){b.arrow=1;b.fill=b.stroke=a.uic.black;a.paintArrow(c,b)};a.paintArrowW=function(c,b){b.arrow=4;b.fill=b.stroke=a.uic.black;a.paintArrow(c,b)}}Toichika.prototype=new Puzzle;
