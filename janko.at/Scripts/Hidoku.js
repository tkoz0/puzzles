function Hidoku(){var a=this;a.constructor();a.uis.puzzle=["Hidoku"];var k=a.board.c,p=0,q=0,m=0,n=0,u=[0,1,1,1,0,-1,-1,-1],v=[-1,-1,0,1,1,1,0,-1];a.enable.dragging=!0;a.enable.values=!1;a.keypadValues=a.keypad.numbers;a.uic.gray="#bbbbbb";a.init=function(){Object.getPrototypeOf(a).init.call(a)};a.reset2=function(){try{p=a.labels.west;q=a.labels.north;m=a.size.x-a.labels.east;n=a.size.y-a.labels.south;a.cell.min=1;a.cell.max=0;if(a.level.problem){var b=0;var c=a.level.problem.replace(/\s+/g," ").trim().split(" ");
for(var d=q;d<n;d++)for(var g=p;g<m;g++){var e=a.board.c[g][d];var f=c[b++];"."!=f&&"-"!=f&&("@"==f?(e.label=0,e.areas=a.cell.outside,e.valid=!1):"x"==f||"#"==f?e.label=0:e.value=parseInt(f));if(e.value!=nil||e.label!=nil)e.fixed=!0;e.label==nil&&a.cell.max++}}if(a.level.solution)for(b=0,c=a.level.solution.replace(/\s+/g," ").trim().split(" "),d=q;d<n;d++)for(g=p;g<m;g++)e=a.board.c[g][d],f=c[b++],"."!=f&&"-"!=f&&"0"!=f&&(e.solution=parseInt(f))}catch(h){throw a.exception(h),h;}};a.check2=function(){try{for(var b=
p;b<m;b++)for(var c=q;c<n;c++)k[b][c].value==nil&&(k[b][c].error=1);for(var d=[],g=[],e=0;e<=a.cell.max;e++)d[e]=g[e]=nil;for(b=p;b<m;b++)for(c=q;c<n;c++){var f=k[b][c];if(f.value!=nil&&0!=f.label){var h=f.value;d[h]==nil?(d[h]=b,g[h]=c):f.error=k[d[h]][g[h]].error=2}}g=d=1;a:for(;d<a.cell.max;){for(b=p;b<m;b++)for(c=q;c<n;c++)if(k[b][c].value==d)for(f=b,h=c,d++;d<=a.cell.max;){e=0;b:for(;8>e;e++){var l=f+u[e],r=h+v[e];if(l>=p&&l<m&&r>=q&&r<n&&k[l][r].value==d){k[f][h].count=k[l][r].count=g;f=l;h=
r;d++;break b}}if(8==e){a.solved=!1;b==f&&c==h||g++;continue a}}d++}}catch(t){throw a.exception(t),t;}};a.dragTo2=function(b,c){try{b.fixed?a.moveTo(b):c.value==nil||c.value==a.cell.max?a.makeMove(b,nil):a.makeMove(b,c.value+1)}catch(d){throw a.exception(d),d;}};a.dragTo2Alt=function(b,c){try{b.fixed?a.moveTo(b):c.value==nil||1==c.value?a.makeMove(b,nil):a.makeMove(b,c.value-1)}catch(d){throw a.exception(d),d;}};a.paintDone=function(){try{var b=a.board.c,c=a.canvas.getContext("2d");if(-1!=a.moves.current||
!a.paintToImage)for(var d=p;d<m;d++)for(var g=q;g<n;g++){var e=a.board.c[d][g];if(e.value!=nil&&0!=e.label)for(var f=0;8>f;f++){var h=d+u[f],l=g+v[f];if(0<=h&&h<m&&0<=l&&l<n&&b[h][l].value==e.value+1){c.lineWidth=Math.floor(a.unit.x/6);var k=(e.count-1)%10;c.strokeStyle=0==k?a.uic.gray:a.uic.light[k];c.beginPath();c.moveTo(e.px+a.unit.x/2,e.py+a.unit.y/2);c.lineTo(b[h][l].px+a.unit.x/2,b[h][l].py+a.unit.y/2);c.stroke()}}}for(d=p;d<m;d++)for(g=q;g<n;g++)e=b[d][g],e.areas!=a.cell.outside&&a.paintCell2nd(e);
a.paintCursor()}catch(t){throw a.exception(t),t;}};a.paintCell=function(b){try{var c=a.canvas.getContext("2d");c.fillStyle=0==b.label?a.uic.black:a.uic.light[b.color];c.fillRect(b.px,b.py,a.unit.x,a.unit.y)}catch(d){throw a.exception(d),d;}};a.paintCell2nd=function(b){try{a.canvas.getContext("2d"),b.value!=nil&&a.paintText(b.value.toString(),b,{color:b.fixed?a.uic.clue:a.uic.text}),a.paintSymbolMarkers(b),b.error&&a.display.errors&&(b.value==nil?a.paintErrorDot(b):a.paintErrorCircle(b))}catch(c){throw a.exception(c),
c;}}}Hidoku.prototype=new Puzzle;
