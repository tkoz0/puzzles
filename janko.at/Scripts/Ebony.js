function Ebony(){var a=this;a.constructor();a.uis.puzzle=["Ebony & Ivory"];var h=a.board.c,m=1,n=1,k=0,l=0,q=nil;a.labels.north=a.labels.south=a.labels.east=a.labels.west=1;a.charToValue=a.charToValue.concat(["a",0,"s",1,"d",nil,"x",0,"c",1,"v",nil,",",0,".",1,"-",nil,"/",nil]);a.cell.values=[0,1,q];a.enable.dragging=!0;a.keypad.left=nil;a.init=function(){Object.getPrototypeOf(a).init.call(a)};a.reset2=function(){try{m=a.labels.west;n=a.labels.north;k=a.size.x-a.labels.east;l=a.size.y-a.labels.south;
if(a.level.clabels){var b=0;var d=a.level.clabels.replace(/\s+/g," ").trim().split(" ");for(var c=0;c<a.size.y;c+=l)for(var e=m;e<k;e++){var g=h[e][c];var f=d[b++];g.label="-"==f||"."==f?nil:parseInt(f)}}if(a.level.rlabels)for(b=0,d=a.level.rlabels.replace(/\s+/g," ").trim().split(" "),e=0;e<a.size.x;e+=k)for(c=n;c<l;c++)g=h[e][c],f=d[b++],g.label="-"==f||"."==f?nil:parseInt(f);a.reset2labels();if(a.level.solution)for(b=0,d=a.level.solution.replace(/\s+/g," ").trim().split(" "),c=n;c<l;c++)for(e=
m;e<k;e++)g=h[e][c],f=d[b++],g.solution="x"==f?0:1;for(e=m;e<k;e++)for(c=n;c<l;c++)h[e][c].areas=Math.floor((e-1)/5%2)==Math.floor((c-1)/5%2)?1:2}catch(p){throw a.exception(p),p;}};a.check2=function(){var b,d,c;try{for(var e=m;e<k;e++)for(var g=n;g<l;g++)h[e][g].value==nil&&(h[e][g].error=1);for(e=m;e<k;e++){var f=b=d=c=0;for(g=n;g<l;g++){switch(h[e][g].value){case 0:f>b&&(b=f);f=0;d++;break;case 1:d>c&&(c=d);d=0;f++;break;case nil:a.solved=!1,f>b&&(b=f),f=0,d>c&&(c=d),d=0}f>b&&(b=f);d>c&&(c=d)}c!=
h[e][0].label&&(h[e][0].error=2);b!=h[e][l].label&&(h[e][l].error=2)}for(g=n;g<l;g++){f=b=d=c=0;for(e=m;e<k;e++){switch(h[e][g].value){case 0:f>b&&(b=f);f=0;d++;break;case 1:d>c&&(c=d);d=0;f++;break;case nil:a.solved=!1,f>b&&(b=f),f=0,d>c&&(c=d),d=0}f>b&&(b=f);d>c&&(c=d)}c!=h[0][g].label&&(h[0][g].error=2);b!=h[k][g].label&&(h[k][g].error=2)}}catch(p){throw a.exception(p),p;}};a.valueToString=function(a,d){switch(a){case nil:return"-";case 0:return"x";case 1:return d?".":"-";default:return"%"}};a.paintCell=
function(b){try{b.areas==a.cell.label?a.paintLabelCell(b):a.paintValueCell(b)}catch(d){throw a.exception(d),d;}};a.paintLabelCell=function(b){try{var d=a.canvas.getContext("2d");d.fillStyle=a.uic.label;d.fillRect(b.px,b.py,a.unit.x,a.unit.y);0==b.x&&0==b.y&&a.paintCircle(b,{fill:a.uic.black,stroke:a.uic.black});b.x==k&&b.y==l?a.paintCircle(b,{fill:a.uic.white,stroke:a.uic.black}):b.label!=nil&&a.paintText(b.label.toString(),b);b.error&&a.display.errors&&a.paintErrorCircle(b)}catch(c){throw a.exception(c),
c;}};a.paintValueCell=function(b){try{var d=a.canvas.getContext("2d");d.fillStyle=b.value==nil?a.paintToImage&&a.moves.current==nil?a.uic.white:a.uic.gray:0==b.value?a.uic.dark[b.color]:a.uic.light[b.color];d.fillRect(b.px,b.py,a.unit.x,a.unit.y);a.paintSymbolMarkers(b);b.error&&a.display.errors&&a.paintErrorDot(b)}catch(c){throw a.exception(c),c;}};a.paintCurrentValue=function(){try{var b=a.uie.value,d=b.getContext("2d");d.fillStyle=a.current.value==q?a.uic.gray:0==a.current.value?a.uic.black:a.uic.white;
d.fillRect(0,0,b.width,b.height)}catch(c){throw a.exception(c),c;}}}Ebony.prototype=new Puzzle;
