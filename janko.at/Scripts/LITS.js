function LITS(){var b=this;b.constructor();b.uis.puzzle=["LITS"];var c=b.board.c,t=b.alist,n=0,p=0,v=[1,0,-1,0],w=[0,1,0,-1];b.charToValue=b.charToValue.concat(["l",76,"i",73,"t",84,"s",83,"o",65,"a",65,".",65,",",0,"x",0,"-",nil,"/",nil]);b.cell.values=[65,0,76,73,84,83,nil];b.enable.dragging=!0;b.cell.nilalias=0;b.keypad.left=nil;b.keypad.right=b.keypad.values;b.uic.tetroFG="#000000";b.uic.tetroBG="#aaaaaa";b.keypadValues=[["L",76],["I",73],["T",84],["S",83],["O",65],["X",0],["\u2022",nil]];b.init=
function(){Object.getPrototypeOf(b).init.call(b)};b.reset2=function(){try{n=b.size.x;p=b.size.y;b.level.areas&&b.reset2areas(0,0,n,p,b.level.areas);if(b.level.problem){var a=0;var f=b.level.problem.replace(/\s+/g," ").trim().split(" ");for(var h=0;h<p;h++)for(var g=0;g<n;g++){var e=c[g][h];var d=f[a++];if("."==d||"-"==d)e.value=nil;else if("L"==d||"l"==d)e.value=76;else if("I"==d||"i"==d)e.value=76;else if("T"==d||"t"==d)e.value=76;else if("S"==d||"s"==d)e.value=79;else if("O"==d||"o"==d)e.value=
79;else if("X"==d||"x"==d)e.value=0;e.value!=nil&&(e.fixed=!0);e.areas<=nil&&(e.value=0)}}if(b.level.solution)for(a=0,f=b.level.solution.replace(/\s+/g," ").trim().split(" "),h=0;h<p;h++)for(g=0;g<n;g++)if(e=c[g][h],d=f[a++],"."==d||"-"==d)e.value=nil;else if("L"==d||"l"==d)e.solution=76;else if("I"==d||"i"==d)e.solution=73;else if("T"==d||"t"==d)e.solution=84;else if("S"==d||"s"==d)e.solution=83;else if("O"==d||"o"==d)e.solution=65}catch(k){throw b.exception(k),k;}};b.check2=function(){try{for(var a=
0;a<n;a++)for(var f=0;f<p;f++)if(!c[a][f].checked&&c[a][f].areas!=b.cell.outside&&c[a][f].areas!=b.cell.black){var h=0;for(var g=n,e=0,d=p,k=0,l=0;l<n;l++)for(var m=0;m<p;m++)c[l][m].areas!=c[a][f].areas?c[l][m].work=nil:(c[l][m].checked=!0,65<=c[l][m].value&&(h++,l<g&&(g=l),l>e&&(e=l),m<d&&(d=m),m>k&&(k=m),c[l][m].work=65));var r=nil;4!=h?b.solved=!1:g==e&&3==k-d||d==k&&3==e-g?r=73:(2==e-g&&1==k-d||1==e-g&&2==k-d)&&(65!=c[g][d].work&&65!=c[e][k].work||65!=c[e][d].work&&65!=c[g][k].work)?r=83:(2==
e-g&&1==k-d||1==e-g&&2==k-d)&&(65!=c[g][d].work&&65!=c[g][k].work||65!=c[e][d].work&&65!=c[e][k].work||65!=c[g][d].work&&65!=c[e][d].work||65!=c[g][k].work&&65!=c[e][k].work)?r=84:1==e-g&&2==k-d&&(65==c[g][d].work&&65==c[g][d+1].work||65==c[e][d].work&&65==c[e][d+1].work||65==c[g][k].work&&65==c[g][k-1].work||65==c[e][k].work&&65==c[e][k-1].work)?r=76:2==e-g&&1==k-d&&(65==c[g][d].work&&65==c[g+1][d].work||65==c[g][k].work&&65==c[g+1][k].work||65==c[e][d].work&&65==c[e-1][d].work||65==c[e][k].work&&
65==c[e-1][k].work)?r=76:b.solved=!1;for(l=0;l<n;l++)for(m=0;m<p;m++)c[l][m].areas==c[a][f].areas&&(r==nil?c[l][m].error=1:65<=c[l][m].value&&(c[l][m].value=r))}for(a=0;a<n;a++)for(f=0;f<p;f++){var q=c[a][f];f<p-1&&65<q.value&&q.value==c[a][f+1].value&&q.areas!=c[a][f+1].areas&&(q.error=c[a][f+1].error=2);a<n-1&&65<q.value&&q.value==c[a+1][f].value&&q.areas!=c[a+1][f].areas&&(q.error=c[a+1][f].error=2)}for(a=0;a<n-1;a++)for(f=0;f<p-1;f++)0<c[a][f].value&&(h=0,0<c[a][f+1].value&&h++,0<c[a+1][f+1].value&&
h++,0<c[a+1][f].value&&h++,3==h&&(c[a][f].error=3,c[a+1][f].error=3,c[a][f+1].error=3,c[a+1][f+1].error=3));h=1;for(a=0;a<n;a++)for(f=0;f<p;f++)q=c[a][f],0<q.value&&0==q.count&&b.markArea(q,h++);2!=h&&(b.solved=!1)}catch(u){throw b.exception(u),u;}};b.solve2=function(){try{for(var a=1;a<t.length;a++)if(4==t[a].length)for(var f=0;f<t[a].length;f++)t[a][f].value=79;for(a=0;a<n-1;a++)for(f=0;f<p-1;f++){var h=c[a][f],g=c[a+1][f],e=c[a][f+1],d=c[a+1][f+1],k=[];h.value!=nil&&(k[k.length]=h);g.value!=nil&&
(k[k.length]=g);e.value!=nil&&(k[k.length]=e);d.value!=nil&&(k[k.length]=d);3==k.length&&(h.value==nil&&(h.value=0),g.value==nil&&(g.value=0),e.value==nil&&(e.value=0),d.value==nil&&(d.value=0))}}catch(l){throw b.exception(l),l;}};b.markArea=function(a,f){try{a.count=f;for(var h=0;4>h;h++){var g=a.x+v[h],e=a.y+w[h];if(0<=g&&g<n&&0<=e&&e<p){var d=c[g][e];0<d.value&&0==d.count&&b.markArea(d,f)}}}catch(k){throw b.exception(k),k;}};b.valueToString=function(a,b){switch(a){case 0:return b?"X":"-";case 76:return"L";
case 73:return"I";case 84:return"T";case 83:return"S";case 79:return"O";case 65:return"O";default:return"-"}};b.paintCell=function(a){try{var c=b.canvas.getContext("2d");c.fillStyle=a.areas==b.cell.black?b.uic.black:b.display.errors&&65<=a.value?b.uic.dark[(a.count-1)%10]:a.value!=nil&&0!=a.value&&0==a.color?b.uic.tetroBG:b.uic.light[a.color];c.fillRect(a.px,a.py,b.unit.x,b.unit.y);if(a.areas!=b.cell.black){var h={color:b.display.errors&&65<=a.value?b.uic.white:b.uic.tetroFG};switch(a.value){case 0:b.paintCross(a);
break;case 76:b.paintText("L",a,h);break;case 73:b.paintText("I",a,h);break;case 84:b.paintText("T",a,h);break;case 83:b.paintText("S",a,h);break;case 65:b.paintText("O",a,h)}b.paintSymbolMarkers(a);0!=a.error&&b.display.errors&&(a.value==nil?b.paintErrorDot(a):b.paintErrorCircle(a))}}catch(g){throw b.exception(g),g;}};b.paintCurrentValue=function(){try{var a=b.uie.value,c=a.getContext("2d");c.fillStyle=b.uic.white;c.fillRect(0,0,a.width,a.height);var h={x:0,y:0,w:a.width,h:a.height,scale:90};switch(b.current.value){case 0:b.paintCross(c,
h);break;case 76:b.paintText("L",c,h);break;case 73:b.paintText("I",c,h);break;case 84:b.paintText("T",c,h);break;case 83:b.paintText("S",c,h);break;case 65:b.paintText("O",c,h)}}catch(g){throw b.exception(g),g;}}}LITS.prototype=new Puzzle;
