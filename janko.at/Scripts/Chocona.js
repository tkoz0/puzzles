function Chocona(){var a=this;a.constructor();a.uis.puzzle=["Chocona"];var h=a.board.c,m=0,n=0,k=0,l=0,u=nil,x=[1,0,-1,0],y=[0,1,0,-1];a.charToValue=a.charToValue.concat(["a",0,"s",1,"d",nil,"x",0,"c",1,"v",nil,",",0,".",1,"-",nil,"/",nil]);a.cell.values=[0,1,u];a.enable.dragging=!0;a.keypad.left=nil;a.cell.nilalias=1;a.uic.dark[0]="#666666";a.init=function(){Object.getPrototypeOf(a).init.call(a)};a.reset2=function(){try{m=a.labels.west;n=a.labels.north;k=a.size.x-a.labels.east;l=a.size.y-a.labels.south;
a.level.areas&&a.reset2areas(m,n,k,l,a.level.areas);if(a.level.problem){var b=0;var d=a.level.problem.replace(/\s+/g," ").trim().split(" ");for(var c=n;c<l;c++)for(var g=m;g<k;g++){var f=d[b++];var e=h[g][c];"."==f||"-"==f?e.label=e.value=nil:"x"==f?e.value=0:"o"==f?e.value=1:e.label=parseInt(f);e.value!=nil&&(e.fixed=!0)}}if(a.level.solution)for(b=0,d=a.level.solution.replace(/\s+/g," ").trim().split(" "),c=n;c<l;c++)for(g=m;g<k;g++)e=h[g][c],f=d[b++],e.solution="x"==f?0:1}catch(q){throw a.exception(q),
q;}};a.check2=function(){var b,d,c,g;try{for(var f=m;f<k;f++)for(var e=n;e<l;e++){var q=h[f][e];if(0==q.marked){var p=null,r=0;for(g=m;g<k;g++)for(c=n;c<l;c++){var t=h[g][c];t.areas==q.areas&&(t.marked=!0,t.label!=nil&&(p=t),0==t.value&&r++)}null!=p&&p.label!=r&&(p.error=1)}}q=1;for(f=m;f<k;++f)for(e=n;e<l;++e)if(0==h[f][e].value&&0==h[f][e].count){g=f;c=e;for(p=g;p<k&&0==h[p][c].value;)p++;for(r=c;r<l&&0==h[g][r].value;)r++;t=!1;for(d=g;d<p;d++)for(b=c;b<r;b++)0==h[d][b].value?h[d][b].count=q:t=
!0;if(t)for(d=g;d<p;d++)for(b=c;b<r;b++)h[d][b].error=3;q++}for(f=m;f<k;++f)for(e=n;e<l;++e)for(c=0;8>c;c++)if(d=f+x[c],b=e+y[c],d>m&&b>n&&d<k&&b<l){var u=h[f][e],v=h[d][b];0!=u.count&&0!=v.count&&u.count!=v.count&&(u.error=v.error=4)}}catch(w){throw a.exception(w),w;}};a.cleanSolution=function(){for(var a=m;a<k;a++)for(var d=n;d<l;d++){var c=h[a][d];c.value==nil&&(c.value=1)}};a.valueToString=function(a,d){switch(a){case nil:return"-";case 0:return"x";case 1:return d?".":"-";default:return"%"}};
a.paintCell=function(b){try{var d=a.canvas.getContext("2d");d.fillStyle=b.value==u?a.paintToImage&&a.moves.current==nil?a.uic.white:a.uic.gray:0==b.value?a.uic.dark[b.color]:a.uic.light[b.color];d.fillRect(b.px,b.py,a.unit.x,a.unit.y);b.label!=nil&&a.paintText(b.label.toString(),b,{color:0!=b.value?a.uic.text:a.uic.text2});a.paintSymbolMarkers(b);a.display.errors&&(1==b.error?a.paintErrorCircle(b):b.error&&a.paintErrorDot(b))}catch(c){throw a.exception(c),c;}};a.paintCurrentValue=function(){try{var b=
a.uie.value,d=b.getContext("2d");d.fillStyle=a.current.value==u?a.uic.gray:0==a.current.value?a.uic.black:a.uic.white;d.fillRect(0,0,b.width,b.height)}catch(c){throw a.exception(c),c;}}}Chocona.prototype=new Puzzle;
